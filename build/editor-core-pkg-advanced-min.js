/*
 Constructor for kissy editor,dependency moved to independent module
 thanks to CKSource's intelligent work on CKEditor
 @author: yiminghe@gmail.com, lifesinger@gmail.com
 @version: 2.1.5
 @buildtime: 2011-01-05 18:09:51
*/
var S=true,T=null,X=false;
KISSY.add("editor",function(k){function w(t,r){var o=this;if(!(o instanceof w))return new w(t,r);if(k.isString(t))t=k.one(t);t=H.C(t);r=r||{};r.Af=r.pluginConfig||{};o.ua=r;r.pluginConfig=r.Af;o.cfg=r;k.app(o,k.EventTarget);var d=["htmldataprocessor","enterkey","clipboard"],f=z;o.use=function(c,j){c=c.split(",");if(!f)for(var u=0;u<d.length;u++){var i=d[u];k.inArray(i,c)||c.unshift(i)}o.ready(function(){k.use.call(o,c.join(","),function(){for(var a=0;a<c.length;a++)o.Xd(c[a]);j&&j.call(o);if(!f){o.setData(t.val());
if(r.focus)o.focus();else(a=o.getSelection())&&a.removeAllRanges();f=C}},{global:w})});return o};o.use=o.use;o.Config.base=w.Config.base;o.Config.debug=w.Config.debug;o.Config.componentJsName=q;o.qf(t);return o}function q(){return"plugin-min.js?t=2011-01-05 18:09:51"}var H=k.DOM,C=S,z=X;k.app(w,k.EventTarget);w.Config.base=k.Config.base+"editor/plugins/";w.Config.debug=k.Config.debug;w.Config.componentJsName=q;k.Editor=w;k.Editor=w});
KISSY.Editor.add("utils",function(k){var w=T,q=KISSY,H=q.Node,C=q.DOM,z=q.UA,t=q.Event,r;if(z.ie)r=document.documentMode||z.ie;var o={md:function(d){d=d.replace(/-min\.(js|css)/i,".$1");k.Config.Ig||(d=d.replace(/\.(js|css)/i,"-min.$1"));if(d.indexOf("?t")==-1){d+=d.indexOf("?")!=-1?"&":"?";d+="t=2011-01-05 18:09:51"}return k.Config.Cg+d},Gd:function(d,f,c){var j=d[f],u=d[c];d[f]=function(){j.apply(this,arguments);d[f]=d[c];return u.apply(this,arguments)}},mf:function(d,f,c,j){c=c.defaultView||c.parentWindow;
d-=C.scrollLeft(c);f-=C.scrollTop(c);if(j)if(c!=(j.defaultView||j.parentWindow)&&c.frameElement){j=C.Pb(c.frameElement,j);d+=j.left;f+=j.top}return{left:d,top:f}},Wd:function(){for(var d,f=0,c=arguments.length;f<c;f++){var j=arguments[f];try{d=j();break}catch(u){}}return d},Me:function(d,f){if(!d&&!f)return S;if(!d||!f||d.length!=f.length)return X;for(var c=0;c<d.length;c++)if(d[c]!==f[c])return X;return S},ud:function(d,f,c){d=d.documentElement;for(var j=0;d&&j<f.length;j++){var u=f[j];if(c)for(var i=
-1,a=0;a<d.childNodes.length;a++){var b=d.childNodes[a];if(!(c===S&&b.nodeType==3&&b.previousSibling&&b.previousSibling.nodeType==3)){i++;if(i==u){d=b;break}}}else d=d.childNodes[u]}return d?new H(d):w},Ue:function(d){for(var f in d)d[f].Oc(d,S)},nc:function(d){return d.replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/,"&gt;")},Qa:function(d){return d.replace(/^\s+/,"")},Sa:function(d){return d.replace(/\s+$/,"")},trim:function(d){return this.Qa(this.Sa(d))},mix:function(){for(var d={},f=0;f<
arguments.length;f++)d=q.mix(d,arguments[f]);return d},qb:function(){if(!z.ie)return X;var d=document.domain,f=window.location.hostname;return d!=f&&d!="["+f+"]"},af:function(d,f){return Array(f+1).join(d)},Kf:function(d,f,c){c=c||150;if(c===-1)return function(){d.apply(f,arguments)};var j=(new Date).getTime();return function(){var u=(new Date).getTime();if(u-j>c){j=u;d.apply(f,arguments)}}},Qe:function(d,f,c){c=c||0;var j=w;return function(){j&&clearTimeout(j);var u=arguments;j=setTimeout(function(){return d.apply(f,
u)},c)}},isNumber:function(d){return/^\d+(.\d+)?$/.test(q.trim(d))},Mf:function(d){for(var f=0;f<d.length;f++){var c=C.C(d[f]),j=q.trim(c.val()),u=c.attr("data-verify");c=c.attr("data-warning");if(u&&!RegExp(u).test(j)){alert(c);return X}}return S},Hf:function(d,f){d.on("sourcemode",f.nd,f);d.on("wysiwygmode",f.pd,f)},Df:function(d){var f=d.attr("placeholder");if(f&&!z.webkit){d.addClass("ke-input-tip");d.val(f)}else z.webkit&&d.val("")},gh:function(d,f){d.removeClass("ke-input-tip");d.val(f)},zf:function(d,
f){d.attr("placeholder",f);if(!z.webkit){d.on("blur",function(){if(!q.trim(d.val())){d.addClass("ke-input-tip");d.val(f)}});d.on("focus",function(){d.removeClass("ke-input-tip");q.trim(d.val())==f&&d.val("")})}},Te:function(d){d=d[0]||d;for(var f=q.makeArray(d.childNodes),c=0;c<f.length;c++){var j=f[c];j.nodeType==k.n.f&&!q.trim(j.nodeValue)&&d.removeChild(j)}},pf:function(d){return!d?d:String(d).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},of:function(d){return!d?
d:String(d).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ef:function(d,f){return d.toLowerCase()==f.toLowerCase()},Hd:function(d){d=q.clone(d);for(var f in d)if(d.hasOwnProperty(f)){var c=d[f];if(q.isFunction(c))d[f]=c()}return d},$e:function(d,f,c){function j(){var B={responseText:"",responseXML:w};B.Le=d?d.Le:w;try{var x;if((x=z.ie?i.contentWindow.document:i.contentDocument||window.frames[u].document)&&x.body)B.responseText=x.body.innerHTML;B.responseXML=
x&&x.XMLDocument?x.XMLDocument:x}catch(D){q.log(D)}t.remove(i,"load",j);d.Re&&d.Re(B);setTimeout(function(){C.h(i)},100)}var u=q.guid("form-upload-"),i=document.createElement("iframe");i.id=u;i.name=u;i.className="ke-hidden";var a="document.open();"+(o.qb()?'document.domain="'+document.domain+'";':"")+"document.close();";if(z.ie)i.src=z.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";q.log("doFormUpload : "+i.src);document.body.appendChild(i);if(z.ie)document.frames[u].name=u;a=C.Vc(d.form);
var b={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action};a.target=u;a.method="POST";a.enctype=a.encoding="multipart/form-data";if(c)a.action=c;var g;if(f){g=[];f=k.k.Hd(f);for(var n in f)if(f.hasOwnProperty(n)){c=document.createElement("input");c.type="hidden";c.name=n;c.value=f[n];a.appendChild(c);g.push(c)}}t.on(i,"load",j);a.submit();a.target=b.target;a.method=b.method;a.enctype=b.enctype;a.encoding=b.encoding;a.action=b.action;if(g){f=0;for(n=g.length;f<n;f++)C.h(g[f])}return i},
o:function(d,f){for(var c in f)d[c]=f[c]},map:function(d,f){for(var c=0;c<d.length;c++)d[c]=f(d[c]);return d},Aa:r,Bf:function(d){z.ie?d.La():d.attr("onmousedown","return false;")},Sg:function(d){d=d.attributes;return d.type=="application/x-shockwave-flash"||/\.swf(?:$|\?)/i.test(d.src||"")},Je:function(){var d=this.ib=this.ib||[];d.push.apply(d,q.makeArray(arguments))},Ze:function(){for(var d=this.ib||[],f=0;f<d.length;f++){var c=d[f];if(q.isFunction(c))c();else{c.detach&&c.detach();c.ya&&c.ya();
c.nodeType&&c.remove&&c.remove()}}this.ib=[]}};k.k=o;k.Utils=o;z.Aa=o.Aa;o.o(o,{debugUrl:o.md,lazyRun:o.Gd,getXY:o.mf,tryThese:o.Wd,arrayCompare:o.Me,getByAddress:o.ud,clearAllMarkers:o.Ue,htmlEncodeAttr:o.nc,ltrim:o.Qa,rtrim:o.Sa,trim:o.trim,mix:o.mix,isCustomDomain:o.qb,duplicateStr:o.af,buffer:o.Qe,isNumber:o.isNumber,verifyInputs:o.Mf,sourceDisable:o.Hf,resetInput:o.Df,placeholder:o.zf,clean:o.Te,htmlEncode:o.pf,htmlDecode:o.of,equalsIgnoreCase:o.ef,normParams:o.Hd,throttle:o.Kf,doFormUpload:o.$e,
map:o.map})});
KISSY.Editor.add("dom",function(k){function w(a){if(a&&!a[0])return new r(a);return a}function q(a){return a[0]||a}function H(a){return a.replace(/-(\w)/g,function(b,g){return g.toUpperCase()})}var C=KISSY,z=C.DOM,t=C.UA,r=C.Node,o=k.k,d={abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1};k.n={e:1,f:3,ce:8,bg:11};k.NODE=k.n;k.$a={ea:0,ee:1,da:2,$:4,Z:8,Jc:16};k.POSITION=
k.$a;var f=k.n,c=k.$a,j={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},u={hr:1},i={C:w,Vc:q,g:function(a,b){if(!a&&!b)return S;if(!a||!b)return X;a=q(a);b=q(b);return a===b},qa:function(a,b){a=w(a);var g=C.mix(C.mix({},u),b||{});return j[a.css("display")]||g[a.d()]},ga:function(a){return a&&"scrollTo"in a&&a.document?a:a&&a.nodeType===9?a.defaultView||a.parentWindow:
X},t:function(a){a=q(a);for(var b=a.parentNode.childNodes,g=0;g<b.length;g++)if(b[g]===a)return g;return-1},le:function(a,b){a=q(a);var g=a.firstChild;if((g=g&&new r(g))&&b&&!b(g))g=g.Ja(b);return g},Tc:function(a,b,g){a=q(a);z.h(a);b=q(b);g?b.insertBefore(a,b.firstChild):b.appendChild(a)},d:function(a){a=q(a);var b=a.nodeName.toLowerCase();if(t.ie)if((a=a.scopeName)&&a!="HTML")b=a.toLowerCase()+":"+b;return b},Rc:function(a,b){if(a.d()!=b.d())return X;var g=a[0].attributes,n=b[0].attributes,B=g.length,
x=n.length;if(B!=x)return X;for(var D=0;D<B;D++){var l=g[D],v=l.name;if(l.specified&&a.attr(v)!=b.attr(v))return X}if(o.Aa<8)for(D=0;D<x;D++){l=n[D];v=l.name;if(l.specified&&a.attr(v)!=b.attr(v))return X}return S},Qb:function(a){a=q(a).childNodes;for(var b=0,g=a.length;b<g;b++){var n=a[b],B=n.nodeType;if(!(B==f.e&&n.getAttribute("_ke_bookmark")))if(B==f.e&&!i.Qb(n)||B==f.f&&C.trim(n.nodeValue))return X}return S},Rb:function(a,b,g){a=q(a);b=b[0]||b;if(a!=b)if(g)for(;g=a.lastChild;)b.insertBefore(a.removeChild(g),
b.firstChild);else for(;g=a.firstChild;)b.appendChild(a.removeChild(g))},ra:function(){function a(b,g,n){if(g[0]&&g[0].nodeType==f.e){for(var B=[];g.attr("_ke_bookmark")||g.Qb();){B.push(g);g=n?new r(g[0].nextSibling):new r(g[0].previousSibling);if(!g[0]||g[0].nodeType!=f.e)return}if(b.Rc(g)){for(var x=n?b[0].lastChild:b[0].firstChild;B.length;)B.shift().Tc(b,!n);g.Rb(b,!n);g.h();x[0]&&x[0].nodeType==f.e&&x.ra()}}}return function(b){if(b[0])if(d[b.d()]||b.d()=="a"){a(b,new r(b[0].nextSibling),S);
a(b,new r(b[0].previousSibling))}}}(),La:t.gecko?function(a){a=q(a);a.style.MozUserSelect="none"}:t.webkit?function(a){a=q(a);a.style.Zf="none"}:function(a){a=q(a);if(t.ie||t.opera){var b=0;a.setAttribute("unselectable","on");for(var g=a.getElementsByTagName("*");a=g[b++];)switch(a.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:a.setAttribute("unselectable","on")}}},Pb:function(a,b){a=q(a);var g,n=0;g=0;var B=a.ownerDocument.defaultView||a.ownerDocument.parentWindow,
x=a.ownerDocument,D=x.documentElement;b=b||x;if(a.getBoundingClientRect){if(a!==x.body&&D!==a){g=a.getBoundingClientRect();n=g.left+(b===x?z.scrollLeft(B):0);g=g.top+(b===x?z.scrollTop(B):0)}if(b)if(B!=(b.defaultView||b.parentWindow)&&B.frameElement){B=i.Pb(B.frameElement,b);n+=B.left;g+=B.top}}return{left:n,top:g}},ne:function(a){return(a=q(a))&&a.contentWindow.document},ia:function(a,b){a=q(a);var g=a.ownerDocument;if(!(!a||a.nodeType!=f.f)){if(t.ie&&b==a.nodeValue.length){var n=g.createTextNode("");
z.insertAfter(n,a);return new r(n)}n=new r(a.splitText(b));if(g.documentMode){g=g.createTextNode("");z.insertAfter(g,n[0]);z.h(g)}return n}},Sb:function(a,b){a=w(a);var g=[];do g[b?"push":"unshift"](a);while(a=a.parent());return g},K:function(a,b,g){a=q(a);a=a.cloneNode(b);if(!g){var n=function(B){if(B.nodeType==f.e){B.removeAttribute("id");B=B.childNodes;for(var x=0;x<B.length;x++)n(B[x])}};n(a)}return new r(a)},v:function(a,b,g,n){a=q(a);if(n&&!n.call){var B=n[0]||n;n=function(D){D=D[0]||D;return D!==
B}}b=!b&&a.firstChild;var x=new r(a);if(!b){if(a.nodeType==f.e&&n&&n(a,S)===X)return T;b=a.nextSibling}for(;!b&&(x=x.parent());){if(n&&n(x,S)===X)return T;b=x[0].nextSibling}if(!b)return T;b=z.C(b);if(n&&n(b)===X)return T;if(g&&g!=b[0].nodeType)return b.v(X,g,n);return b},ha:function(a,b,g,n){a=q(a);if(n&&!n.call){var B=n[0]||n;n=function(D){D=D[0]||D;return D!==B}}b=!b&&a.lastChild;var x=new r(a);if(!b){if(a.nodeType==f.e&&n&&n(a,S)===X)return T;b=a.previousSibling}for(;!b&&(x=x.parent());){if(n&&
n(x,S)===X)return T;b=x[0].previousSibling}if(!b)return T;b=z.C(b);if(n&&n(b)===X)return T;if(g&&b[0].nodeType!=g)return b.ha(X,g,n);return b},Ob:function(a,b){if(a.g(b))return a;if(b[0].nodeType!=f.f&&b.contains(a))return b;var g=a[0].nodeType==f.f?a.parent():a;do if(g[0].nodeType!=f.f&&g.contains(b))return g;while(g=g.parent());return T},Nc:function(a,b,g){a=q(a);if(!g)a=a.parentNode;if(b&&!C.isFunction(b)){var n=b;b=function(B){return B.d()==n}}for(;a&&a.nodeType!=9;){if(!b||b(new r(a))===S)return new r(a);
a=a.parentNode}return T},Pc:o.Aa<9?function(a,b){a=q(a);var g=a.attributes[b];return!!(g&&g.specified)}:function(a,b){a=q(a);return a.hasAttribute(b)},eb:o.Aa<9?function(a){a=q(a);for(var b=a.attributes,g=0;g<b.length;g++){var n=b[g];switch(n.name){case "class":if(a.getAttribute("class"))return S;break;default:if(n.specified)return S}}return X}:function(a){a=q(a);t.gecko&&a.removeAttribute("_moz_dirty");return a.hasAttributes()},Ka:function(a,b){var g=q(a),n=q(b);if(g.compareDocumentPosition)return g.compareDocumentPosition(n);
if(g==n)return c.ea;if(g.nodeType==f.e&&n.nodeType==f.e){if(g.contains){if(g.contains(n))return c.Jc+c.$;if(n.contains(g))return c.Z+c.da}if("sourceIndex"in g)return g.sourceIndex<0||n.sourceIndex<0?c.ee:g.sourceIndex<n.sourceIndex?c.$:c.da}g=a.Ia();n=b.Ia();for(var B=Math.min(g.length,n.length),x=0;x<=B-1;x++)if(g[x]!=n[x]){if(x<B)return g[x]<n[x]?c.$:c.da;break}return g.length<n.length?c.Jc+c.$:c.Z+c.da},Ia:function(a,b){a=q(a);for(var g=[],n=a.ownerDocument.documentElement,B=a;B&&B!=n;){var x=
B.parentNode,D=-1;if(x){for(var l=0;l<x.childNodes.length;l++){var v=x.childNodes[l];if(!(b&&v.nodeType==3&&v.previousSibling&&v.previousSibling.nodeType==3)){D++;if(v==B)break}}g.unshift(D)}B=x}return g},Nb:function(a,b){var g=new k.Range(a[0].ownerDocument);g.setStartAfter(a);g.setEndAfter(b);var n=g.extractContents();g.insertNode(a.h());a[0].parentNode.insertBefore(n,a[0].nextSibling)},L:function(a,b,g){a=w(a);if(g!==undefined)return a.css(b,g);a=q(a);return a.style[H(b)]},h:function(a,b){var g=
q(a),n=g.parentNode;if(n){if(b)for(var B;B=g.firstChild;)n.insertBefore(g.removeChild(B),g);n.removeChild(g)}return a},gb:function(a){z.Sc(a);z.Uc(a)},Sc:function(a){a=q(a);for(var b;b=a.firstChild;){if(b.nodeType==f.f){var g=o.Qa(b.nodeValue),n=b.nodeValue.length;if(g){if(g.length<n){(new r(b)).ia(n-g.length);a.removeChild(a.firstChild)}}else{a.removeChild(b);continue}}break}},Uc:function(a){a=q(a);for(var b;b=a.lastChild;){if(b.type==f.f){var g=o.Sa(b.nodeValue),n=b.nodeValue.length;if(g){if(g.length<
n){(new r(b)).ia(g.length);a.removeChild(a.lastChild)}}else{a.removeChild(b);continue}}break}if(!t.ie&&!t.opera)(b=a.lastChild)&&b.nodeType==1&&b.nodeName.toLowerCase()=="br"&&b.parentNode.removeChild(b)},Mb:function(a){a=q(a);for(var b=a.lastChild;b&&b.nodeType==f.f&&!C.trim(b.nodeValue);)b=b.previousSibling;if(!b||b.nodeType==f.f||z.d(b)!=="br"){b=t.opera?a.ownerDocument.createTextNode(""):a.ownerDocument.createElement("br");t.gecko&&b.setAttribute("type","_moz");a.appendChild(b)}},sa:function(a,
b){var g=q(a),n;do n=(g=g.previousSibling)&&new r(g);while(n&&b&&!b(n));return n},pe:function(a,b){a=z.C(a);var g=a[0].lastChild;if((g=g&&new r(g))&&b&&!b(g))g=g.sa(b);return g},Ja:function(a,b){var g=q(a),n;do n=(g=g.nextSibling)&&new r(g);while(n&&b&&!b(n));return n},fb:function(a){a=q(a);if(a.outerHTML)return a.outerHTML.replace(/<\?[^>]*>/,"");var b=a.ownerDocument.createElement("div");b.appendChild(a.cloneNode(S));return b.innerHTML},qe:function(a,b,g,n){a=z.C(a);var B=a.data("list_marker_id")||
a.data("list_marker_id",C.guid()).data("list_marker_id"),x=a.data("list_marker_names")||a.data("list_marker_names",{}).data("list_marker_names");b[B]=a;x[g]=1;return a.data(g,n)},Oc:function(a,b,g){a=w(a);var n=a.data("list_marker_names"),B=a.data("list_marker_id"),x;for(x in n)a.removeData(x);a.removeData("list_marker_names");if(g){a.removeData("list_marker_id");delete b[B]}},ke:function(a,b,g){a=q(a);b=w(b);var n=a.attributes;g=g||{};for(var B=0;B<n.length;B++){var x=n[B],D=x.name.toLowerCase(),
l;if(!(D in g))if(D=="checked"&&(l=z.attr(a,D)))b.attr(D,l);else if(x.specified||t.ie&&x.value&&D=="value"){l=z.attr(a,D);if(l===T)l=x.nodeValue;b.attr(D,l)}}if(a.style.cssText!=="")b[0].style.cssText=a.style.cssText},Qc:function(a){a=z.d(a);var b=k.m;return(a=!b.Gc[a]&&(b[a]||b.span))&&a["#"]},Tb:function(a){a=w(a);var b=a[0].ownerDocument,g=z.scrollLeft(b),n=z.scrollTop(b),B=a.offset(),x=B.left;B=B.top;if(z.viewportHeight(b)+n<B||B<n||z.viewportWidth(b)+g<x||x<g)a.scrollIntoView(b)},me:function(a,
b,g){a=q(a);if(!t.ie&&g)b=g+":"+b;g=[];a=a.getElementsByTagName(b);for(b=0;b<a.length;b++)g.push(new r(a[b]));return g}};C.DOM.oe=function(a){C.mix(z,a);for(var b in a)a.hasOwnProperty(b)&&function(g){r.prototype[g]=function(){var n=[].slice.call(arguments,0);n.unshift(this);return a[g].apply(T,n)}}(b)};o.o(i,{_4e_wrap:i.C,_4e_unwrap:i.Vc,_4e_equals:i.g,_4e_isBlockBoundary:i.qa,_4e_getWin:i.ga,_4e_index:i.t,_4e_first:i.le,_4e_move:i.Tc,_4e_name:i.d,_4e_isIdentical:i.Rc,_4e_isEmptyInlineRemoveable:i.Qb,
_4e_moveChildren:i.Rb,_4e_mergeSiblings:i.ra,_4e_unselectable:i.La,_4e_getOffset:i.Pb,_4e_getFrameDocument:i.ne,_4e_splitText:i.ia,_4e_parents:i.Sb,_4e_clone:i.K,_4e_nextSourceNode:i.v,_4e_previousSourceNode:i.ha,_4e_commonAncestor:i.Ob,_4e_ascendant:i.Nc,_4e_hasAttribute:i.Pc,_4e_hasAttributes:i.eb,_4e_position:i.Ka,_4e_address:i.Ia,_4e_breakParent:i.Nb,_4e_style:i.L,_4e_remove:i.h,_4e_trim:i.gb,_4e_ltrim:i.Sc,_4e_rtrim:i.Uc,_4e_appendBogus:i.Mb,_4e_last:i.pe,_4e_previous:i.sa,_4e_next:i.Ja,_4e_outerHtml:i.fb,
_4e_setMarker:i.qe,_4e_clearMarkers:i.Oc,_4e_getUniqueId:i.ng,_4e_copyAttributes:i.ke,_4e_isEditable:i.Qc,_4e_scrollIntoView:i.Tb,_4e_getElementsByTagName:i.me});z.oe(i)});
KISSY.Editor.add("focusmanager",function(k){function w(){this.oc=o;r=this}function q(){this.oc=d;r=f}var H=KISSY,C=H.DOM,z=H.Event,t={},r;H={Yg:function(){for(var c in t){var j=t[c];j.document.designMode="off";j.document.designMode="on"}},Hg:function(){return r},hf:function(c){return t[c]},add:function(c){var j=C.ga(c.document);z.on(j,"focus",w,c);z.on(j,"blur",q,c)},Cf:function(c){t[c.Ub]=c},remove:function(c){delete t[c.Ub];var j=C.ga(c.document);z.remove(j,"focus",w,c);z.remove(j,"blur",q,c)}};
var o=S,d=X,f=T;k.rd=H;k.focusManager=H;k.jf=function(){return t};k.getInstances=k.jf});
KISSY.Editor.add("definition",function(k){var w=S,q=X,H=k.k,C=document,z=KISSY,t=z.UA,r=z.DOM,o=z.Node,d=z.Event,f=k.rd,c=H.Wd,j=1,u="document.open();"+(H.qb()?'document.domain="'+C.domain+'";':"")+"document.close();",i="<div  class='ke-editor-wrap'  > <div class='"+".ke-editor-tools".substring(1)+"' ></div><div class='"+".ke-textarea-wrap".substring(1)+'\'><iframe  style="width:100%;height:100%;border:none;"  width="100%"  height="100%"  frameborder="0"  title="kissy-editor"  src="'+(t.ie?"javascript:void(function(){"+
encodeURIComponent(u)+"}())":"")+'"  tabIndex="'+(t.webkit?-1:"$(tabIndex)")+'"  allowTransparency="true" ></iframe></div><div class=\''+".ke-editor-status".substring(1)+"'></div></div>";k.Lc=0;k.db=1;k.SOURCE_MODE=k.Lc;k.WYSIWYG_MODE=k.db;z.augment(k,{qf:function(a){var b=this;b.hb={};b.Ma={};b.ta={};t.ie&&r.addClass(C.body,"ke-ie"+t.ie);if(t.trident)r.addClass(C.body,"ke-trident"+t.trident);else if(t.gecko)r.addClass(C.body,"ke-gecko");else t.webkit&&r.addClass(C.body,"ke-webkit");var g=new o(i.replace(/\$\(tabIndex\)/,
a.attr("tabIndex")));b.cf=g;b.Ub=j++;f.Cf(b);b.Wa=g.one(".ke-textarea-wrap");b.wrap=b.Wa;b.Ba=b.Wa.one("iframe");b.iframe=b.Ba;b.Vd=g.one(".ke-editor-tools");b.toolBarDiv=b.Vd;b.W=a;b.textarea=b.W;b.Jf=g.one(".ke-editor-status");b.statusDiv=b.Jf;H.Bf(b.Vd);var n=a.L("width"),B=a.L("height");if(n){g.css("width",n);a.css("width","100%")}b.W.css("display","none");g.insertAfter(a);b.Wa[0].appendChild(a[0]);if(B){b.Wa.css("height",B);a.css("height","100%")}g=b.Ba;b.on("dataReady",function(){b.Ae=w;k.fire("instanceCreated",
{bf:b})});t.gecko?g.on("load",b.bd,b):b.bd();b.ua.attachForm&&a[0].form&&b.ve()},ya:function(){if(!this.te){var a=this.cf,b=this.W,g=this.document,n=this.Ba[0].contentWindow;this.Bb();k.rd.remove(this);d.remove(g);d.remove(g.documentElement);d.remove(g.body);d.remove(n);this.Ba.detach();g=this.ta;for(var B in g)if(g.hasOwnProperty(B)){n=g[B];n.ya&&n.ya()}this.fire("destroy");b.insertBefore(a);a.remove();b.css({width:a.css("width"),height:this.Wa.css("height")});b.show();this.hb=this.Ma=this.ta=T;
this.detach();this.te=S}},ve:function(){var a=this,b=new o(a.W[0].form);b.on("submit",a.Bb,a);a.on("destroy",function(){b.detach("submit",a.Bb,a)})},Lf:function(a,b){var g=this,n=k.de;n&&n.qc();g.use(a,function(){var B=g.vd(a);if(B){b(B);n&&n.fh()}else z.later(arguments.callee,50,X,g)})},Ie:function(a,b){this.Ma[a]=b},vd:function(a){return this.Ma[a]},Kg:function(a){var b=this.Ma[a];b&&b.ya();this.Ma[a]=T},Ge:function(a,b){this.hb[a]=b},nf:function(a){return this.hb[a]},execCommand:function(a){var b=
this.hb[a],g=z.makeArray(arguments);g.shift();g.unshift(this);return b.exec.apply(b,g)},jc:function(){return this.W.css("display")=="none"?k.db:k.Lc},getData:function(a){var b;b=this.jc()==k.db?this.document&&this.document.body?this.document.body.innerHTML:"":this.W.val();if(this.htmlDataProcessor)b=a?this.htmlDataProcessor.toHtml(b,"p"):this.htmlDataProcessor.toServer(b,"p");b=z.trim(b);if(/^<p>((&nbsp;)|\s)*<\/p>$/.test(b))b="";return b},setData:function(a){var b=a;if(this.htmlDataProcessor)b=this.htmlDataProcessor.toDataFormat(a,
"p");this.document.body.innerHTML=b;this.jc()!=k.db&&this.W.val(a)},Bb:function(){this.W.val(this.getData())},pg:function(){return this.document.body.innerHTML},tg:function(a){this.document.body.innerHTML=a},ze:function(a){var b=this.ua,g=b.cc;b=b.xa;var n="",B=k.k.md("../theme/editor-iframe.css");if(b)for(var x=0;x<b.length;x++)n+='<link href="'+b[x]+'" rel="stylesheet"/>';return"<!doctype html><html><head><title>${title}</title><link href='"+B+"' rel='stylesheet'/><style>"+(g||"")+"</style>"+n+
"</head><body class='ke-editor'>&nbsp;"+(a?'<script id="ke_actscript" type="text/javascript">'+(H.qb()?'document.domain="'+C.domain+'";':"")+'window.parent.KISSY.Editor._initIFrame("'+a+'");<\/script>':"")+"</body></html>"},getSelection:function(){return k.Mc.getSelection(this.document)},focus:function(){var a=this.document,b=r.ga(a);t.webkit&&b&&b.parent&&b.parent.focus();t.webkit&&b&&b.focus();a&&a.body.focus();this.ub()},blur:function(){r.ga(this.document).blur();this.document&&this.document.body.blur()},
He:function(a){var b=this.ua,g=this.document;b.cc=b.cc||"";b.cc+="\n"+a;b=g.createElement("style");g.getElementsByTagName("head")[0].appendChild(b);if(b.styleSheet)b.styleSheet.cssText=a;else b.appendChild(g.createTextNode(a))},zg:function(a){var b=this.ua,g=this.document;b.xa=b.xa||[];b.xa.push(a);b=g.createElement("link");b.rel="stylesheet";g.getElementsByTagName("head")[0].appendChild(b);b.href=a},Zg:function(a){for(var b=this.ua,g=z.makeArray(this.document.getElementsByTagName("link")),n=0;n<
g.length;n++)g[n].href==a&&r.h(g[n]);b.xa=b.xa||[];b=b.xa;a=z.indexOf(a,b);a!=-1&&b.splice(a,1)},bd:function(){function a(){x=B.document;b.document=x;g.detach();x.open("text/html","replace");x.write(n);x.close()}var b=this,g=b.Ba,n=b.ze(b.Ub),B=g[0].contentWindow,x;try{x=B.document}catch(D){g[0].src=g[0].src;if(t.ie<7){setTimeout(a,10);return}}a()},ready:function(a){this.Ae?a():this.on("dataReady",a)},Ag:function(a,b,g){this.ta=this.ta;g=g||{};g.gf=b;this.ta[a]=g},Xd:function(a){var b=this.ta[a];
if(b)if(!(b.status&&!b.duplicate)){a=this.Env.mods[a].requires||[];for(var g=0;g<a.length;g++)this.Xd(a[g]);b.gf.call(b);b.status=1}},jb:function(){var a=this;a.Zc&&clearTimeout(a.Zc);a.Zc=setTimeout(function(){var b=a.getSelection();if(b&&!b.Dd){var g=b.ob(),n=new k.Za(g);if(!a.vc||!a.vc.kd(n)){a.vc=n;a.fire("selectionChange",{selection:b,path:n,element:g})}}},100)},ub:function(){this.vc=T;this.jb()},Cd:function(a,b,g){var n=this;n.focus();setTimeout(function(){var B,x=a.d(),D=k.m,l=k.oa,v=k.n,I=
D.Xa[x],s=n.getSelection(),e=s&&s.H(),h,m,y,p;if(!e||e.length==0){var A=arguments,Q=A.callee;setTimeout(function(){Q.apply(n,A)},30)}else{n.fire("save");for(var O=e.length-1;O>=0;O--){h=e[O];h.deleteContents();B=!O&&a||a.K(w);b&&b(B);if(I)for(;(y=h.za(q,w))&&(p=D[y.d()])&&!(p&&p[x]);)if(y.d()in D.span)h.Ac(y);else if(h.va()&&h.ka()){h.setStartBefore(y);h.collapse(w);y.h()}else h.zc();h.insertNode(B);m||(m=B)}if(m){x=m.v(w);D=n.document;p=k.m;if(p.Ec[B.d()]){x=new o(D.createTextNode(" "));x.insertAfter(m)}else if(x){if(x.d()==
"br"&&p[x.parent().d()].p){p=new o("<p>&nbsp;</p>",T,D);x[0].parentNode.replaceChild(p[0],x[0]);x=p}}else{p=new o("<p>&nbsp;</p>",T,D);p.insertAfter(m);x=p}h.G(m,l.r);x&&x[0].nodeType==v.e&&h.sb(x);s.Ab([h]);n.focus();B&&B.Tb();setTimeout(function(){n.fire("save")},10);g&&g(B)}}},0)},rf:function(a){var b=this;if(b.htmlDataProcessor)a=b.htmlDataProcessor.toDataFormat(a);if(t.webkit){var g=r.create(a,T,b.document);g=g.nodeType==11?z.makeArray(g.childNodes):[g];for(var n=0;n<g.length;n++)b.Cd(new o(g[n]))}else{b.focus();
setTimeout(function(){var B=b.getSelection();B=B&&B.H();if(!B||B.length==0){var x=arguments,D=x.callee;setTimeout(function(){D.apply(b,x)},30)}else{b.fire("save");if(document.selection){B=document.selection;B.type=="Control"&&B.clear();B.createRange().pasteHTML(a)}else b.document.execCommand("inserthtml",q,a);setTimeout(function(){b.fire("save")},10)}},0)}}});k._initIFrame=function(a){function b(s){c(function(){B.designMode="on";setTimeout(function(){B.designMode="off";D.focus();if(!arguments.callee.Ef)arguments.callee.Ef=
w},50)},function(){B.designMode="off";r.attr(D,"contentEditable",q);r.attr(D,"contentEditable",w);!s&&b(1)})}var g=f.hf(a);a=g.W[0];var n=g.Ba[0].contentWindow,B=g.document,x=g.ua;r.h(B.getElementById("ke_actscript"));var D=B.body;if(t.ie){D.hideFocus=w;D.disabled=w;D.contentEditable=w;D.removeAttribute("disabled")}else setTimeout(function(){if(t.gecko||t.opera)D.contentEditable=w;else if(t.webkit)D.parentNode.contentEditable=w;else B.designMode="on"},0);if(t.webkit){d.on(B,"click",function(s){var e=
new o(s.target);z.inArray(e.d(),["input","select"])&&s.preventDefault()});d.on(B,"mouseup",function(s){var e=new o(s.target);z.inArray(e.d(),["input","textarea"])&&s.preventDefault()})}if(t.gecko||t.ie||t.opera){var l;l=new o(r.insertAfter((new o('<span tabindex="-1" style="position:absolute; left:-10000" role="presentation"></span>'))[0],a));l.on("focus",function(){g.focus()});g.yg=function(){t.gecko&&g.oc&&l[0].focus()};g.on("destroy",function(){l.detach();l.remove()})}if(t.ie&&B.compatMode=="CSS1Compat"||
B.documentMode||t.gecko||t.opera){var v=B.documentElement;d.on(v,"mousedown",function(s){if(s.target==v){t.gecko&&b(q);l[0].focus()}})}d.on(n,"focus",function(){if(t.gecko)b(q);else t.opera&&D.focus();g.ub()});t.gecko&&d.on(g.document,"mousedown",function(){g.oc||b(q)});if(t.ie){d.on(B,"keydown",function(s){if(s.keyCode in{8:1,46:1}){var e=g.getSelection(),h=e.kc();if(h){g.fire("save");var m=e.H()[0].O();h.h();e.Rd([m]);g.fire("save");s.preventDefault()}}});if(B.compatMode=="CSS1Compat"){var I={33:1,
34:1};d.on(B,"keydown",function(s){s.keyCode in I&&setTimeout(function(){g.getSelection().scrollIntoView()},0)})}}setTimeout(function(){t.ie&&setTimeout(function(){if(B){D.runtimeStyle.marginBottom="0px";D.runtimeStyle.marginBottom=""}},1E3)},0);setTimeout(function(){g.fire("dataReady");var s=x.disableObjectResizing,e=x.disableInlineTableEditing;if(s||e)try{B.execCommand("enableObjectResizing",q,!s);B.execCommand("enableInlineTableEditing",q,!e)}catch(h){d.on(D,t.ie?"resizestart":"resize",function(m){var y=
new o(m.target);if(s||y.d()==="table"&&e)m.preventDefault()})}},10);t.webkit&&d.on(B,"mousedown",function(s){s=new o(s.target);z.inArray(s.d(),["img","hr","input","textarea","select"])&&g.getSelection().yc(s)});t.gecko&&d.on(B,"dragstart",function(s){var e=new o(s.target);e.d()==="img"&&/ke_/.test(e[0].className)&&s.preventDefault()});f.add(g)};u=k.prototype;H.o(u,{setData:u.setData,getData:u.getData,insertElement:u.Cd,insertHtml:u.rf,ready:u.ready,addCustomStyle:u.He,addCommand:u.Ge,hasCommand:u.nf,
execCommand:u.execCommand,useDialog:u.Lf,addDialog:u.Ie,getDialog:u.vd,getMode:u.jc,sync:u.Bb,getSelection:u.getSelection,focus:u.focus,blur:u.blur,notifySelectionChange:u.ub})});KISSY.Editor.add("zindex",function(){var k=KISSY.Editor;if(!k.Bc){k.Bc={Sf:1100,hg:1200,Uf:99999,ag:900,gg:9999,LOADING:11E3,$f:12E3,fe:1200};k.Yb=function(w){return(k.Tf.Yb||1E4)+w};k.baseZIndex=k.Yb;k.zIndexManager=k.Bc}});
KISSY.Editor.add("dtd",function(k){k.m=function(){function w(D){for(var l=arguments.length-1;l>0;)KISSY.mix(D,arguments[l--]);return D}var q={isindex:1,fieldset:1},H={input:1,button:1,select:1,textarea:1,label:1},C=w({a:1},H),z=w({iframe:1},C),t={hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1},r={ins:1,del:1,script:1,style:1},o=w({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,
s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1},r),d=w({sub:1,img:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1},o),f=w({p:1},d);H=w({iframe:1},d,H);d={img:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,
del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1};var c=w({a:1},H),j={tr:1},u={"#":1},i=w({param:1},d),a=w({form:1},q,z,t,f),b={li:1},g={base:1,link:1,meta:1,title:1},n=w(g,{style:1,script:1}),B={head:1,body:1},x={address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1};return{Eb:w({html:1},B,g),Xa:x,Qf:{body:1,div:1,td:1,th:1,caption:1,
form:1},Ec:c,Cc:w({script:1,style:1},x),Dc:{script:1,style:1},Cb:{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1},Db:{dd:1,dt:1,li:1},Yd:{ul:1,ol:1,dl:1},Gc:{applet:1,button:1,embed:1,iframe:1,map:1,object:1,option:1,script:1,textarea:1,param:1},ca:{abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},Rf:{a:1,area:1,button:1,input:1,object:1,select:1,
textarea:1},Hc:{caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1},html:B,head:n,style:u,body:a,base:{},link:{},meta:{},title:u,col:{},tr:{td:1,th:1},img:{},colgroup:{col:1},noscript:a,td:a,br:{},th:a,center:a,kbd:c,button:w(f,t),basefont:{},h5:c,h4:c,samp:c,h6:c,ol:b,h1:c,h3:c,option:u,h2:c,form:w(q,z,t,f),select:{optgroup:1,option:1},font:c,ins:c,menu:b,abbr:c,label:c,table:{thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1},code:c,script:u,tfoot:j,cite:c,li:a,input:{},iframe:a,
strong:c,textarea:u,noframes:a,big:c,small:c,span:c,hr:{},dt:c,sub:c,optgroup:{option:1},param:{},bdo:c,"var":c,div:a,object:i,sup:c,dd:a,strike:c,area:{},dir:b,map:w({area:1,form:1,p:1},q,r,t),applet:i,dl:{dt:1,dd:1},del:c,isindex:{},fieldset:w({Tg:1},d),thead:j,ul:b,acronym:c,b:c,a:H,blockquote:a,caption:c,i:c,u:c,tbody:j,s:c,address:w(z,f),tt:c,legend:c,q:c,pre:w(o,C),p:c,em:c,dfn:c}}();k.XHTML_DTD=k.m});
KISSY.Editor.add("elementpath",function(k){function w(d){var f=z,c=z,j=[];for(d=d;d&&d[0];){if(d[0].nodeType==C.e){if(!this.vf)this.vf=d;var u=d.d();if(!c){if(!f&&t[u])f=d;if(r[u]){var i;if(i=!f){if(i=u=="div"){a:{i=d;i=i[0]||i;i=i.childNodes;for(var a=0,b=i.length;a<b;a++){var g=i[a];if(g.nodeType==C.e&&H.Xa[g.nodeName.toLowerCase()]){i=S;break a}}i=X}i=!i}i=i}if(i)f=d;else c=d}}j.push(d);if(u=="body")break}d=d.parent()}this.block=this.w=f;this.blockLimit=this.D=c;this.elements=this.elements=j}var q=
KISSY.DOM,H=k.m,C=k.n,z=T,t={address:1,blockquote:1,dl:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1,li:1,dt:1,dd:1},r={body:1,div:1,table:1,tbody:1,tr:1,td:1,th:1,caption:1,form:1};w.prototype={kd:function(d){var f=this.elements;d=d&&d.elements;if(!d||f.length!=d.length)return X;for(var c=0;c<f.length;c++)if(!q.g(f[c],d[c]))return X;return S},contains:function(d){for(var f=this.elements,c=0;c<f.length;c++)if(f[c].d()in d)return f[c];return z}};k.ElementPath=k.Za=w;var o=w.prototype;k.k.o(o,{compare:o.kd,
contains:o.contains})});
KISSY.Editor.add("walker",function(k){function w(j,u){if(this.c.end)return t;var i,a=this.Da,b,g=this.lc,n=this.type,B=j?"_4e_previousSourceNode":"_4e_nextSourceNode";if(!this.c.start){this.c.start=1;a.trim();if(a.collapsed){this.end();return t}}if(!j&&!this.c.yd){var x=a.endContainer,D=new f(x[0].childNodes[a.endOffset]);this.c.yd=function(s,e){return(s=d.C(s))&&s[0]&&(!e||!d.g(x,s))&&(!D[0]||!s.g(D))&&(s[0].nodeType!=o.e||!e||s.d()!="body")}}if(j&&!this.c.zd){var l=a.startContainer,v=a.startOffset>
0&&new f(l[0].childNodes[a.startOffset-1]);this.c.zd=function(s,e){return(s=d.C(s))&&s[0]&&(!e||!s.g(l))&&(!v[0]||!s.g(v))&&(s[0].nodeType!=o.e||!e||s.d()!="body")}}var I=j?this.c.zd:this.c.yd;b=g?function(s,e){if(I(s,e)===z)return z;return g(s,e)}:I;if(this.mb)i=this.mb[B](z,n,b);else if(j){i=a.endContainer;if(a.endOffset>0){i=new f(i[0].childNodes[a.endOffset-1]);if(b(i)===z)i=t}else i=b(i,C)===z?t:i.ha(C,n,b)}else{i=a.startContainer;if((i=new f(i[0].childNodes[a.startOffset]))&&i[0]){if(b(i)===
z)i=t}else i=b(a.startContainer,C)===z?t:a.startContainer.v(C,n,b)}for(;i&&i[0]&&!this.c.end;){this.mb=i;if(!this.R||this.R(i)!==z){if(!u)return i}else if(u&&this.R)return z;i=i[B](z,n,b)}this.end();return this.mb=t}function q(j){for(var u,i=t;u=w.call(this,j);)i=u;return i}function H(j){this.Da=j;this.c={}}var C=S,z=X,t=T,r=KISSY,o=k.n,d=r.DOM,f=r.Node;r.augment(H,{end:function(){this.c.end=1},next:function(){return w.call(this)},xb:function(){return w.call(this,C)},jd:function(){return w.call(this,
z,C)!==z},hd:function(){return w.call(this,C,C)!==z},Fd:function(){return q.call(this)},Ed:function(){return q.call(this,C)},reset:function(){delete this.mb;this.c={}}});H.Zb=function(j){return function(u){u=d.C(u);return!(u&&u[0].nodeType==o.e&&u.qa(j))}};H.xf=function(){return this.Zb({$b:1})};H.Na=function(j,u){function i(a){return a&&a[0]&&a.d()=="span"&&a.attr("_ke_bookmark")}return function(a){var b,g;b=a&&a[0]&&a[0].nodeType==o.f&&(g=a.parent())&&i(g);b=j?b:b||i(a);return u^b}};H.Va=function(j){return function(u){u=
(u=u[0]||u)&&u.nodeType==o.f&&!r.trim(u.nodeValue);return j^u}};H.sf=function(j){var u=H.Va();return function(i){i=u(i)||i[0].nodeType==o.e&&!i[0].offsetHeight;return j^i}};k.Ha=H;k.Walker=H;var c=H.prototype;k.k.o(c,{end:c.end,next:c.next,previous:c.xb,checkForward:c.jd,checkBackward:c.hd,lastForward:c.Fd,lastBackward:c.Ed,reset:c.reset});k.k.o(H,{blockBoundary:H.Zb,listItemBoundary:H.xf,bookmark:H.Na,whitespaces:H.Va,invisible:H.sf})});
KISSY.Editor.add("range",function(k){function w(e){this.endOffset=this.endContainer=this.startOffset=this.startContainer=d;this.collapsed=r;this.document=e}function q(e){var h=e[0].nodeType!=c.f&&e.d()in n.ca,m=!f.trim(e[0].nodeValue);e=!!e.parent().attr("_ke_bookmark");return h||m||e}function H(e){return!v(e)&&!I(e)}function C(e){var h=o,m=i.Na(r);return function(y){if(m(y))return r;if(y[0].nodeType==c.f){if(f.trim(y[0].nodeValue).length)return o}else if(y[0].nodeType==c.e)if(!l[y.d()])if(!e&&!g.ie&&
y.d()=="br"&&!h)h=r;else return o;return r}}function z(e,h){function m(y){return y&&y.nodeName=="span"&&y.getAttribute("_ke_bookmark")}return function(y){var p,A;p=y&&!y.nodeName&&(A=y.parentNode)&&m(A);p=e?p:p||m(y);return h^p}}function t(e){return function(h){h=(h=h[0]||h)&&h.nodeType==c.f&&!f.trim(h.nodeValue);return e^h}}k.oa={Y:1,J:2,B:3,r:4,Hb:1,Gb:2,Ya:3,bb:1,be:2,ig:3,fa:1,Kc:2};k.RANGE=k.oa;var r=S,o=X,d=T,f=KISSY,c=k.n,j=k.oa,u=k.$a,i=k.Ha,a=f.DOM,b=k.k.ud,g=f.UA,n=k.m,B=k.Za,x=f.Node,D=
{area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1};w.prototype.toString=function(){var e=[];e.push((this.startContainer[0].id||this.startContainer[0].nodeName)+":"+this.startOffset);e.push((this.endContainer[0].id||this.endContainer[0].nodeName)+":"+this.endOffset);return e.join("<br/>")};f.augment(w,{Ua:function(){this.collapsed=this.startContainer&&this.endContainer&&a.g(this.startContainer,this.endContainer)&&this.startOffset==this.endOffset},tc:function(){var e=this.startContainer,
h=this.startOffset;if(e[0].nodeType!=c.e)if(h)h>=e[0].nodeValue.length&&this.setStartAfter(e);else this.setStartBefore(e);e=this.endContainer;h=this.endOffset;if(e[0].nodeType!=c.e)if(h)h>=e[0].nodeValue.length&&this.setEndAfter(e);else this.setEndBefore(e)},setStartAfter:function(e){this.setStart(e.parent(),e.t()+1)},setStartBefore:function(e){this.setStart(e.parent(),e.t())},setEndAfter:function(e){this.setEnd(e.parent(),e.t()+1)},setEndBefore:function(e){this.setEnd(e.parent(),e.t())},uc:function(){var e=
this.startContainer,h=this.endContainer;e&&e.d()=="span"&&e.attr("_ke_bookmark")&&this.V(e,j.B);h&&h.d()=="span"&&h.attr("_ke_bookmark")&&this.U(h,j.r)},setStart:function(e,h){if(e[0].nodeType==c.e&&D[e.d()]){e=e.parent();h=e.t()}this.startContainer=e;this.startOffset=h;if(!this.endContainer){this.endContainer=e;this.endOffset=h}this.Ua()},setEnd:function(e,h){if(e[0].nodeType==c.e&&D[e.d()]){e=e.parent();h=e.t()+1}this.endContainer=e;this.endOffset=h;if(!this.startContainer){this.startContainer=
e;this.startOffset=h}this.Ua()},V:function(e,h){switch(h){case j.Y:this.setStart(e,0);break;case j.J:e[0].nodeType==c.f?this.setStart(e,e[0].nodeValue.length):this.setStart(e,e[0].childNodes.length);break;case j.B:this.setStartBefore(e);break;case j.r:this.setStartAfter(e)}this.Ua()},U:function(e,h){switch(h){case j.Y:this.setEnd(e,0);break;case j.J:e[0].nodeType==c.f?this.setEnd(e,e[0].nodeValue.length):this.setEnd(e,e[0].childNodes.length);break;case j.B:this.setEndBefore(e);break;case j.r:this.setEndAfter(e)}this.Ua()},
fc:function(e,h){var m=this.startContainer,y=this.endContainer,p=this.startOffset,A=this.endOffset,Q,O=this.document,M;this.uc();if(y[0].nodeType==c.f)y=y.ia(A);else if(y[0].childNodes.length>0)if(A>=y[0].childNodes.length){y=new x(y[0].appendChild(O.createTextNode("")));M=r}else y=new x(y[0].childNodes[A]);if(m[0].nodeType==c.f){m.ia(p);if(m.g(y))y=new x(m[0].nextSibling)}else if(p)if(p>=m[0].childNodes.length){Q=new x(O.createTextNode(""));m.append(Q);m=Q;Q=r}else m=new x(m[0].childNodes[p].previousSibling);
else{Q=new x(O.createTextNode(""));m.prepend(Q);m=Q;Q=r}p=m.Sb();A=y.Sb();var P,U,W;for(P=0;P<p.length;P++){U=p[P];W=A[P];if(!U.g(W))break}O=h;for(var V,Z,ca,E=P;E<p.length;E++){V=p[E];Z=O&&!V.g(m)?O.appendChild(V.K()[0]):T;for(V=V[0].nextSibling;V;){if(a.g(A[E],V)||a.g(y,V))break;ca=V.nextSibling;if(e==2)O.appendChild(V.cloneNode(r));else{a.h(V);e==1&&O.appendChild(V)}V=ca}if(Z)O=Z}O=h;for(P=P;P<A.length;P++){V=A[P];Z=O&&e>0&&!V.g(y)?O.appendChild(V.K()[0]):T;if(!p[P]||!V.parent().g(p[P].parent()))for(V=
V[0].previousSibling;V;){if(a.g(p[P],V)||a.g(m,V))break;ca=V.previousSibling;if(e==2)O.insertBefore(V.cloneNode(r),O.firstChild);else{a.h(V);e==1&&O.insertBefore(V,O.firstChild)}V=ca}if(Z)O=Z}if(e==2){W=this.startContainer[0];if(W.nodeType==c.f&&W.nextSibling&&W.nextSibling.nodeType==c.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}W=this.endContainer[0];if(W.nodeType==c.f&&W.nextSibling&&W.nextSibling.nodeType==c.f){W.data+=W.nextSibling.data;W.parentNode.removeChild(W.nextSibling)}}else{if(U&&
W&&(!m.parent().g(U.parent())||!y.parent().g(W.parent()))){U=W.t();Q&&W.parent().g(m.parent())&&U--;this.setStart(W.parent(),U)}this.collapse(r)}Q&&m.h();M&&y[0].parentNode&&y.h()},collapse:function(e){if(e){this.endContainer=this.startContainer;this.endOffset=this.startOffset}else{this.startContainer=this.endContainer;this.startOffset=this.endOffset}this.collapsed=r},clone:function(){var e=new w(this.document);e.startContainer=this.startContainer;e.startOffset=this.startOffset;e.endContainer=this.endContainer;
e.endOffset=this.endOffset;e.collapsed=this.collapsed;return e},wd:function(){var e=this.clone();e.tc();if(e.startContainer[0].nodeType!=c.e||e.endContainer[0].nodeType!=c.e)return d;var h=new k.Ha(e),m=z(r,undefined),y=t(r);e.R=function(p){return y(p)&&m(p)};e=h.next();h.reset();h=h.xb();return e&&e.g(h)?e:d},Ta:function(e,h){if(!this.collapsed){e=e||j.Kc;var m=this.clone(),y=this.startContainer,p=this.endContainer,A=this.startOffset,Q=this.endOffset,O=1,M=1;if(y&&y[0].nodeType==c.f)if(A)if(A>=y[0].nodeValue.length)m.setStartAfter(y);
else{m.setStartBefore(y);O=0}else m.setStartBefore(y);if(p&&p[0].nodeType==c.f)if(Q)if(Q>=p[0].nodeValue.length)m.setEndAfter(p);else{m.setEndAfter(p);M=0}else m.setEndBefore(p);m=new i(m);m.R=function(U){U=U[0]||U;return U.nodeType==(e==j.fa?c.e:c.f)};var P;m.lc=function(U,W){U=U[0]||U;if(e==j.fa&&U.nodeType==c.f)return o;if(W&&U==P)return o;if(!W&&U.nodeType==c.e)P=U;return r};if(O)(y=m[e==j.fa?"lastForward":"next"]())&&this.V(y,h?j.Y:j.B);if(M){m.reset();(m=m[e==j.fa?"lastBackward":"previous"]())&&
this.U(m,h?j.J:j.r)}return!!(O||M)}},lf:function(){var e=this.startContainer;if(this.collapsed||e[0].nodeType!=c.e)return e;return e.childNodes[this.startOffset]||e},ld:function(e){var h=this.startContainer,m=this.endContainer,y=this.startOffset,p=this.endOffset,A,Q;if(!h||!m)return{start:0,end:0};if(e){if(h[0].nodeType==c.e)if((A=new x(h[0].childNodes[y]))&&A[0]&&A[0].nodeType==c.f&&y>0&&A[0].previousSibling.nodeType==c.f){h=A;y=0}for(;h[0].nodeType==c.f&&(Q=h.sa())&&Q[0].nodeType==c.f;){h=Q;y+=
Q[0].nodeValue.length}if(!this.collapsed){if(m[0].nodeType==c.e)if((A=new x(m[0].childNodes[p]))&&A[0]&&A[0].nodeType==c.f&&p>0&&A[0].previousSibling.nodeType==c.f){m=A;p=0}for(;m[0].nodeType==c.f&&(Q=m.sa())&&Q[0].nodeType==c.f;){m=Q;p+=Q[0].nodeValue.length}}}return{start:h.Ia(e),end:this.collapsed?d:m.Ia(e),startOffset:y,endOffset:p,Id:e,tf:r}},O:function(e){var h,m,y,p,A=this.collapsed;h=new x("<span>",d,this.document);h.attr("_ke_bookmark",1);h.css("display","none");h.html("&nbsp;");if(e){y=
f.guid("ke_bm_");h.attr("id",y+"S")}if(!A){m=h.K();m.html("&nbsp;");e&&m.attr("id",y+"E");p=this.clone();p.collapse();p.insertNode(m)}p=this.clone();p.collapse(r);p.insertNode(h);if(m){this.setStartAfter(h);this.setEndBefore(m)}else this.G(h,j.r);return{aa:e?y+"S":h,Q:e?y+"E":m,Td:e,collapsed:A}},G:function(e,h){this.V(e,h);this.collapse(r)},trim:function(e,h){var m=this.startContainer,y=this.startOffset,p=this.collapsed;if((!e||p)&&m[0]&&m[0].nodeType==c.f){if(y)if(y>=m[0].nodeValue.length){y=m.t()+
1;m=m.parent()}else{var A=m.ia(y);y=m.t()+1;m=m.parent();if(a.g(this.startContainer,this.endContainer))this.setEnd(A,this.endOffset-this.startOffset);else if(a.g(m,this.endContainer))this.endOffset+=1}else{y=m.t();m=m.parent()}this.setStart(m,y);if(p){this.collapse(r);return}}m=this.endContainer;y=this.endOffset;if(!(h||p)&&m[0]&&m[0].nodeType==c.f){if(y){y>=m.nodeValue.length||m.ia(y);y=m.t()+1}else y=m.t();m=m.parent();this.setEnd(m,y)}},insertNode:function(e){this.uc();this.trim(o,r);var h=this.startContainer;
h[0].insertBefore(e[0]||e,h[0].childNodes[this.startOffset]||T);a.g(e.parent(),this.endContainer)&&this.endOffset++;this.setStartBefore(e)},moveToBookmark:function(e){if(e.tf){var h=b(this.document,e.start,e.Id),m=e.startOffset,y=e.end&&b(this.document,e.end,e.Id);e=e.endOffset;this.setStart(h,m);y?this.setEnd(y,e):this.collapse(r)}else{h=(m=e.Td)?f.one("#"+e.aa,this.document):e.aa;e=m?f.one("#"+e.Q,this.document):e.Q;this.setStartBefore(h);h.h();if(e&&e[0]){this.setEndBefore(e);e.h()}else this.collapse(r)}},
za:function(e,h){var m=this.startContainer,y=this.endContainer;m=a.g(m,y)?e&&m[0].nodeType==c.e&&this.startOffset==this.endOffset-1?new x(m[0].childNodes[this.startOffset]):m:m.Ob(y);return h&&m[0].nodeType==c.f?m.parent():m},Oa:function(e){switch(e){case j.Hb:if(this.collapsed)break;e=this.za();var h=new x(this.document.body),m,y,p,A,Q,O=o,M,P;M=this.startContainer;P=this.startOffset;if(M[0].nodeType==c.f){if(P){M=!f.trim(M[0].nodeValue.substring(0,P)).length&&M;O=!!M}if(M)if(!(A=M[0].previousSibling))p=
M.parent()}else{if(P)A=M[0].childNodes[P-1]||M[0].lastChild;A||(p=M)}for(;p||A;){if(p&&!A){if(!Q&&a.g(p,e))Q=r;if(!h.contains(p))break;if(!O||p.css("display")!="inline"){O=o;if(Q)m=p;else this.setStartBefore(p)}A=p[0].previousSibling}for(;A;){M=o;if(A.nodeType==c.f){P=A.nodeValue;if(/[^\s\ufeff]/.test(P))A=d;M=/[\s\ufeff]$/.test(P)}else if(A.offsetWidth>0&&!A.getAttribute("_ke_bookmark"))if(O&&n.ca[A.nodeName.toLowerCase()]){P=a.text(A);if(/[^\s\ufeff]/.test(P))A=d;else for(var U=A.all||A.getElementsByTagName("*"),
W=0,V;V=U[W++];)if(!n.ca[V.nodeName.toLowerCase()]){A=d;break}if(A)M=!!P.length}else A=d;if(M)if(O)if(Q)m=p;else p&&this.setStartBefore(p);else O=r;if(A){M=A.previousSibling;if(!p&&!M){p=new x(A);A=d;break}A=M}else p=d}if(p)p=p.parent()}M=this.endContainer;P=this.endOffset;p=A=d;Q=O=o;if(M[0].nodeType==c.f){M=!f.trim(M[0].nodeValue.substring(P)).length&&M;O=!(M&&M[0].nodeValue.length);if(M)if(!(A=M[0].nextSibling))p=M.parent()}else(A=M[0].childNodes[P])||(p=M);for(;p||A;){if(p&&!A){if(!Q&&a.g(p,e))Q=
r;if(!h.contains(p))break;if(!O||p.css("display")!="inline"){O=o;if(Q)y=p;else p&&this.setEndAfter(p)}A=p[0].nextSibling}for(;A;){M=o;if(A.nodeType==c.f){P=A.nodeValue;if(/[^\s\ufeff]/.test(P))A=d;M=/^[\s\ufeff]/.test(P)}else if(A.offsetWidth>0&&!A.getAttribute("_ke_bookmark"))if(O&&n.ca[A.nodeName.toLowerCase()]){P=a.text(A);if(/[^\s\ufeff]/.test(P))A=d;else{U=A.all||A.getElementsByTagName("*");for(W=0;V=U[W++];)if(!n.ca[V.nodeName.toLowerCase()]){A=d;break}}if(A)M=!!P.length}else A=d;if(M)if(O)if(Q)y=
p;else this.setEndAfter(p);if(A){M=A.nextSibling;if(!p&&!M){p=new x(A);A=d;break}A=M}else p=d}if(p)p=p.parent()}if(m&&y){e=m.contains(y)?y:m;this.setStartBefore(e);this.setEndAfter(e)}break;case j.Gb:case j.Ya:p=new w(this.document);h=new x(this.document.body);p.V(h,j.Y);p.setEnd(this.startContainer,this.startOffset);p=new i(p);var Z,ca,E=i.Zb(e==j.Ya?{$b:1}:d),K=function(F){var G=E(F);G||(Z=F);return G};m=function(F){var G=K(F);if(!G&&F[0]&&F.d()=="br")ca=F;return G};p.lc=K;p=p.Ed();Z=Z||h;this.V(Z,
Z.d()!="br"&&(!p&&this.va()||p&&Z.contains(p))?j.Y:j.r);p=this.clone();p.collapse();p.U(h,j.J);p=new i(p);p.lc=e==j.Ya?m:K;Z=d;p=p.Fd();Z=Z||h;this.U(Z,!p&&this.ka()||p&&Z.contains(p)?j.J:j.B);ca&&this.setEndAfter(ca)}},va:function(){var e=this.startContainer,h=this.startOffset;if(h&&e[0].nodeType==c.f)if(f.trim(e[0].nodeValue.substring(0,h)).length)return o;this.trim();e=new B(this.startContainer);h=this.clone();h.collapse(r);h.V(e.w||e.D,j.Y);e=new i(h);e.R=C(r);return e.hd()},ka:function(){var e=
this.endContainer,h=this.endOffset;if(e[0].nodeType==c.f)if(f.trim(e[0].nodeValue.substring(h)).length)return o;this.trim();e=new B(this.endContainer);h=this.clone();h.collapse(o);h.U(e.w||e.D,j.J);e=new i(h);e.R=C(o);return e.jd()},deleteContents:function(){this.collapsed||this.fc(0)},extractContents:function(){var e=this.document.createDocumentFragment();this.collapsed||this.fc(1,e);return e},bc:function(e,h){var m=this.clone();m[h==j.bb?"setStartAt":"setEndAt"](e,h==j.bb?j.Y:j.J);m=new i(m);m.R=
q;return m[h==j.bb?"checkBackward":"checkForward"]()},sd:function(){var e=this.startContainer,h=this.endContainer,m=this.startOffset,y=this.endOffset,p;if(e[0].nodeType==c.e){p=e[0].childNodes.length;if(p>m)e=new x(e[0].childNodes[m]);else if(p<1)e=e.ha();else{for(e=e[0];e.lastChild;)e=e.lastChild;e=new x(e);e=e.v()||e}}if(h[0].nodeType==c.e){p=h[0].childNodes.length;if(p>y)h=(new x(h[0].childNodes[y])).ha(r);else if(p<1)h=h.ha();else{for(h=h[0];h.lastChild;)h=h.lastChild;h=new x(h)}}if(e.Ka(h)&u.da)e=
h;return{aa:e,Q:h}},nb:function(e,h){var m=this.O(),y=new x(this.document.createElement(h));this.collapse(e);this.Oa(j.Gb);y[0].appendChild(this.extractContents());y.gb();g.ie||y.Mb();this.insertNode(y);this.moveToBookmark(m);return y},zc:function(e){var h=new B(this.startContainer),m=new B(this.endContainer),y=h.w,p=m.w,A=d;if(!h.D.g(m.D))return d;if(e!="br"){if(!y){y=this.nb(r,e);p=(new B(this.endContainer)).w}p||(p=this.nb(o,e))}e=y&&this.va();h=p&&this.ka();this.deleteContents();if(y&&a.g(y,p))if(h){A=
new B(this.startContainer);this.G(p,j.r);p=d}else if(e){A=new B(this.startContainer);this.G(y,j.B);y=d}else{p=this.Ac(y);!g.ie&&!f.inArray(y.d(),["ul","ol"])&&y.Mb()}return{Xg:y,Vg:p,Of:e,Nf:h,Pg:A}},Ac:function(e){if(!this.collapsed)return d;this.U(e,j.J);var h=this.extractContents(),m=e.K(o);m[0].appendChild(h);m.insertAfter(e);this.G(e,j.r);return m},sb:function(e,h){var m,y=k.m;if(y.Cb[e.d()])return o;for(;e&&e[0].nodeType==c.e;){if(m=e.Qc())this.G(e,h?j.J:j.Y);else if(y.Ec[e.d()]){this.G(e,h?
j.r:j.B);return r}if((e=y.Cb[e.d()]?e[h?"_4e_previous":"_4e_next"](H):e[h?"_4e_last":"_4e_first"](H))&&e[0].nodeType==c.f){this.G(e,h?j.r:j.B);return r}}return m},selectNodeContents:function(e){this.setStart(e,0);this.setEnd(e,e[0].nodeType==c.f?e[0].nodeValue.length:e[0].childNodes.length)}});var l={abbr:1,acronym:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1},v=new i.Va,I=new i.Na;k.Range=
w;k.Range=w;var s=w.prototype;k.k.o(s,{updateCollapsed:s.Ua,optimize:s.tc,setStartAfter:s.setStartAfter,setEndAfter:s.setEndAfter,setStartBefore:s.setStartBefore,setEndBefore:s.setEndBefore,optimizeBookmark:s.uc,setStart:s.setStart,setEnd:s.setEnd,setStartAt:s.V,setEndAt:s.U,execContentsAction:s.fc,collapse:s.collapse,clone:s.clone,getEnclosedNode:s.wd,shrink:s.Ta,getTouchedStartNode:s.lf,createBookmark2:s.ld,createBookmark:s.O,moveToPosition:s.G,trim:s.trim,insertNode:s.insertNode,moveToBookmark:s.moveToBookmark,
getCommonAncestor:s.za,enlarge:s.Oa,checkStartOfBlock:s.va,checkEndOfBlock:s.ka,deleteContents:s.deleteContents,extractContents:s.extractContents,checkBoundaryOfElement:s.bc,getBoundaryNodes:s.sd,fixBlock:s.nb,splitBlock:s.zc,splitElement:s.Ac,moveToElementEditablePosition:s.sb,selectNodeContents:s.selectNodeContents})});
KISSY.Editor.add("domiterator",function(k){function w(i){if(!(arguments.length<1)){this.Da=i;this.hc=H;this.qd=q;this.ec=H;this.c||(this.c={})}}var q=S,H=X,C=KISSY,z=C.UA,t=k.Ha,r=k.Range,o=k.oa,d=k.n,f=k.Za,c=C.Node,j=C.DOM,u=/^[\r\n\t ]*$/;C.augment(w,{kf:function(i){var a,b,g,n,B;if(!this.c.I){b=this.Da.clone();b.Ta(o.fa,q);b.Oa(this.hc||!this.qd?o.Ya:o.Gb);var x=new t(b),D=t.Na(q,q);x.R=D;this.c.la=x.next();x=new t(b);x.R=D;x=x.xb();this.c.I=x.v(q);if(this.c.I&&this.c.I[0].nodeType==d.f&&!C.trim(this.c.I[0].nodeValue)&&
this.c.I.parent().qa()){D=new r(b.document);D.G(this.c.I,o.r);if(D.ka()){D=new f(D.endContainer);this.c.I=(D.w||D.D).v(q)}}if(!this.c.I){this.c.I=this.c.od=new c(b.document.createTextNode(""));j.insertAfter(this.c.I[0],x[0])}b=T}D=this.c.la;x=this.c.I;for(this.c.la=T;D;){var l=H,v=D[0].nodeType!=d.e,I=H;if(v){if(D[0].nodeType==d.f)if(u.test(D[0].nodeValue))v=H}else{var s=D.d();if(D.qa(this.hc&&{$b:1})){if(s=="br")v=q;else if(!b&&!D[0].childNodes.length&&s!="hr"){a=D;g=D.g(x);break}if(b){b.U(D,o.B);
if(s!="br")this.c.la=D}l=q}else{if(D[0].firstChild){if(!b){b=new r(this.Da.document);b.V(D,o.B)}D=new c(D[0].firstChild);continue}v=q}}if(v&&!b){b=new r(this.Da.document);b.V(D,o.B)}g=(!l||v)&&D.g(x);if(b&&!l)for(;!D[0].nextSibling&&!g;){s=D.parent();if(s.qa(this.hc&&{$b:1})){l=q;g||s.g(x);break}D=s;v=q;g=D.g(x);I=q}v&&b.U(D,o.r);D=D.v(I,T,x);if((g=!D)||l&&b)break}if(!a){if(!b){this.c.od&&this.c.od.h();return this.c.la=T}a=new f(b.startContainer);D=a.D;l={Lg:1,eh:1,dh:1};a=a.w;if((!a||!a[0])&&!this.ec&&
l[D.d()]&&b.va()&&b.ka())a=D;else if(!a||this.ec&&a.d()=="li"){a=new c(this.Da.document.createElement(i||"p"));a[0].appendChild(b.extractContents());a.gb();b.insertNode(a);n=B=q}else if(a.d()!="li"){if(!b.va()||!b.ka()){a=a.K(H);a[0].appendChild(b.extractContents());a.gb();B=b.zc();n=!B.Of;B=!B.Nf;b.insertNode(a)}}else if(!g)this.c.la=a.g(x)?T:b.sd().Q.v(q,T,x)}if(n){b=new c(a[0].previousSibling);if(b[0]&&b[0].nodeType==d.e)if(b.d()=="br")b.h();else b[0].lastChild&&j.d(b[0].lastChild)=="br"&&j.h(b[0].lastChild)}if(B){b=
t.Na(H,q);n=new c(a[0].lastChild);if(n[0]&&n[0].nodeType==d.e&&n.d()=="br")if(z.ie||n.sa(b)||n.Ja(b))n.h()}if(!this.c.la)this.c.la=g||a.g(x)?T:a.v(q,T,x);return a}});r.prototype.Ye=function(){return new w(this)}});
KISSY.Editor.add("selection",function(k){function w(l){this.document=this.document=l;this.c={M:{}};if(a){var v=this.z().createRange();if(!v||v.item&&v.item(0).ownerDocument!=l||v.parentElement&&v.parentElement().ownerDocument!=l)this.Dd=C}}function q(l){l=new w(l);return!l||l.Dd?t:l}function H(l){var v=l.document,I=new c(v.body),s=new c(v.documentElement);if(o.ie){o.Aa<8&&s.on("click",function(M){(new c(M.target)).d()==="html"&&l.getSelection().z().createRange().select()});var e,h,m=1;s.on("mousedown",
function(){m=0});s.on("mouseup",function(){m=1});I.on("focusin",function(M){if((new c(M.target)).d()=="body")if(e){try{m&&e.select()}catch(P){}e=t}});I.on("focus",function(){h=C;p()});I.on("beforedeactivate",function(M){if(!M.relatedTarget){y();m=1}});f.on(d.ga(v),"blur",function(){try{v&&v.selection.empty()}catch(M){}});I.on("mousedown",function(){y()});I.on("mouseup",function(){h=C;setTimeout(function(){p(C)},0)});var y=function(){h=z},p=function(M){if(h){var P=l.document,U=l.getSelection(),W=U&&
U.pb(),V=U&&P.selection;if(M&&V&&W==j.Jb)if(!P.queryCommandEnabled("InsertImage")){setTimeout(function(){p(C)},50);return}var Z;if(!(V&&W==j.pa&&(Z=d.d(U.ob()))&&Z in{input:1,textarea:1})){e=V&&V.createRange();l.jb()}}};I.on("keydown",y);I.on("keyup",function(){h=C;p()});f.on(v,"selectionchange",p)}else{f.on(v,"mouseup",l.jb,l);f.on(v,"keyup",l.jb,l)}var A={table:1,pre:1},Q=/\s*<(p|div|address|h\d|center)[^>]*>\s*(?:<br[^>]*>|&nbsp;|\u00A0|&#160;)?\s*(:?<\/\1>)?(?=\s*$|<\/body>)/gi,O=k.Ha.Va(C);l.on("selectionChange",
function(M){var P=M.path;M=(M=M.selection)&&M.H()[0];if(!(!M||!M.collapsed||P.w))if(P.D.d()=="body"){P=M.nb(C,"p");if(P.fb().match(Q)){var U=P.Ja(O);if(U&&U[0].nodeType==i.e&&!A[U.d()]){M.sb(U);P.h()}else if((U=P.sa(O))&&U[0].nodeType==i.e&&!A[U.d()]){M.sb(U,U.fb().match(Q)?z:C);P.h()}}M.select();a||l.ub()}})}k.ge={Jb:1,pa:2,ab:3};var C=S,z=X,t=T,r=KISSY,o=r.UA,d=r.DOM,f=r.Event,c=r.Node,j=k.ge,u=k.oa,i=k.n,a=!window.getSelection,b=k.Ha,g=k.Range,n={img:1,hr:1,li:1,table:1,tr:1,td:1,th:1,embed:1,
object:1,ol:1,ul:1,a:1,input:1,form:1,select:1,textarea:1,button:1,fieldset:1,thead:1,tfoot:1};r.augment(w,{z:!a?function(){var l=this.c.M;return l.rc||(l.rc=d.ga(this.document).getSelection())}:function(){var l=this.c.M;return l.rc||(l.rc=this.document.selection)},pb:!a?function(){var l=this.c.M;if(l.type)return l.type;var v=j.pa,I=this.z();if(I){if(I.rangeCount==1){I=I.getRangeAt(0);var s=I.startContainer;if(s==I.endContainer&&s.nodeType==i.e&&I.endOffset-I.startOffset===1&&n[s.childNodes[I.startOffset].nodeName.toLowerCase()])v=
j.ab}}else v=j.Jb;return l.type=v}:function(){var l=this.c.M;if(l.type)return l.type;var v=j.Jb;try{var I=this.z(),s=I.type;if(s=="Text")v=j.pa;if(s=="Control")v=j.ab;if(I.createRange().parentElement)v=j.pa}catch(e){}return l.type=v},H:a?function(){function l(v,I){v=v.duplicate();v.collapse(I);for(var s=v.parentElement(),e=s.childNodes,h,m=0;m<e.length;m++){var y=e[m];if(y.nodeType==i.e){h=v.duplicate();h.moveToElementText(y);y=h.compareEndPoints("StartToStart",v);var p=h.compareEndPoints("EndToStart",
v);h.collapse();if(y>0)break;else if(!y||p==1&&y==-1)return{wa:s,offset:m};else if(!p)return{wa:s,offset:m+1};h=t}}if(!h){h=v.duplicate();h.moveToElementText(s);h.collapse(z)}h.setEndPoint("StartToStart",v);h=String(h.text).replace(/\r\n|\r/g,"\n").length;try{for(;h>0;)h-=e[--m].nodeValue.length}catch(A){h=0}return h===0?{wa:s,offset:m}:{wa:e[m],offset:-h}}return function(){var v=this.c.M;if(v.na)return v.na;var I=this.z(),s=I&&I.createRange(),e=this.pb();if(!I)return[];if(e==j.pa){I=new g(this.document);
e=l(s,C);I.setStart(new c(e.wa),e.offset);e=l(s);I.setEnd(new c(e.wa),e.offset);return v.na=[I]}else if(e==j.ab){v=v.na=[];for(e=0;e<s.length;e++){var h=s.item(e),m=h.parentNode,y=0;for(I=new g(this.document);y<m.childNodes.length&&m.childNodes[y]!=h;y++);I.setStart(new c(m),y);I.setEnd(new c(m),y+1);v.push(I)}return v}return v.na=[]}}():function(){var l=this.c.M;if(l.na)return l.na;var v=[],I=this.z();if(!I)return[];for(var s=0;s<I.rangeCount;s++){var e=I.getRangeAt(s),h=new g(this.document);h.setStart(new c(e.startContainer),
e.startOffset);h.setEnd(new c(e.endContainer),e.endOffset);v.push(h)}return l.na=v},ob:function(){var l=this.c.M;if(l.Ud!==undefined)return l.Ud;var v,I=this.z();switch(this.pb()){case j.ab:return this.kc();case j.pa:var s=this.H()[0];if(s)if(!s.collapsed){for(s.tc();C;){v=s.startContainer;if(s.startOffset==(v[0].nodeType===i.e?v[0].childNodes.length:v[0].nodeValue.length)&&!v.qa())s.setStartAfter(v);else break}v=s.startContainer;if(v[0].nodeType!=i.e)return v.parent();v=new c(v[0].childNodes[s.startOffset]);
if(!v[0]||v[0].nodeType!=i.e)return s.startContainer;for(s=v[0].firstChild;s&&s.nodeType==i.e;){v=new c(s);s=s.firstChild}return v}if(a){s=I.createRange();s.collapse(C);v=s.parentElement()}else if((v=I.anchorNode)&&v.nodeType!=i.e)v=v.parentNode}return l.Ud=v?d.C(v):t},kc:function(){var l=this,v,I=l.c.M;if(I.Sd!==undefined)return I.Sd;if(a){v=l.z().createRange();v=v.item&&v.item(0)}v||(v=function(){for(var s=l.H()[0],e,h,m=2;m&&!((e=s.wd())&&e[0].nodeType==i.e&&n[e.d()]&&(h=e));m--)s.Ta(u.fa);return h&&
h[0]}());return I.Sd=d.C(v)},reset:function(){this.c.M={}},yc:function(l){var v,I=this.document;if(a)try{v=I.body.createControlRange();v.addElement(l[0]);v.select()}catch(s){v=I.body.createTextRange();v.moveToElementText(l[0]);v.select()}finally{}else{v=I.createRange();v.selectNode(l[0]);l=this.z();l.removeAllRanges();l.addRange(v)}this.reset()},Ab:function(l){if(a){if(l.length>1){var v=l[l.length-1];l[0].setEnd(v.endContainer,v.endOffset);l.length=1}l[0]&&l[0].select()}else{v=this.z();if(!v)return;
v.removeAllRanges();for(var I=0;I<l.length;I++){var s=l[I],e=this.document.createRange(),h=s.startContainer;s.collapsed&&o.gecko&&o.gecko<1.09&&h[0].nodeType==i.e&&!h[0].childNodes.length&&h[0].appendChild(this.document.createTextNode(""));e.setStart(h[0],s.startOffset);e.setEnd(s.endContainer[0],s.endOffset);v.addRange(e)}}this.reset()},Xe:function(l){for(var v=[],I=this.H(),s=0;s<I.length;s++)v.push(I[s].ld(l));return v},We:function(l,v){var I=[],s=this.document,e;v=v||this.H();for(var h=v.length,
m=0;m<h;m++){I.push(e=v[m].O(l,C));var y=(l=e.Td)?r.one("#"+e.aa,s):e.aa;e=l?r.one("#"+e.Q,s):e.Q;for(var p=m+1;p<h;p++){var A=v[p],Q=A.startContainer,O=A.endContainer;d.g(Q,y.parent())&&A.startOffset++;d.g(Q,e.parent())&&A.startOffset++;d.g(O,y.parent())&&A.endOffset++;d.g(O,e.parent())&&A.endOffset++}}return I},Rd:function(l){for(var v=[],I=0;I<l.length;I++){var s=new g(this.document);s.moveToBookmark(l[I]);v.push(s)}this.Ab(v);return this},za:function(){var l=this.H();return l[0].startContainer.Ob(l[l.length-
1].endContainer)},scrollIntoView:function(){var l=this.ob();l&&l.Tb()},removeAllRanges:function(){var l=this.z();if(a)l&&l.clear();else l&&l.removeAllRanges()}});var B={table:1,tbody:1,tr:1},x=b.Va(C),D=/\ufeff|\u00a0/;g.prototype.select=g.prototype.select=!a?function(){var l=this.startContainer;this.collapsed&&l[0].nodeType==i.e&&!l[0].childNodes.length&&l[0].appendChild(this.document.createTextNode(""));var v=this.document.createRange();v.setStart(l[0],this.startOffset);try{v.setEnd(this.endContainer[0],
this.endOffset)}catch(I){if(I.toString().indexOf("NS_ERROR_ILLEGAL_VALUE")>=0){this.collapse(C);v.setEnd(this.endContainer[0],this.endOffset)}else throw I;}l=q(this.document).z();l.removeAllRanges();l.addRange(v)}:function(l){var v=this.collapsed,I,s;if(this.startContainer[0]===this.endContainer[0]&&this.endOffset-this.startOffset==1){var e=this.startContainer[0].childNodes[this.startOffset];if(e.nodeType==i.e){(new w(this.document)).yc(new c(e));return}}if(this.startContainer[0].nodeType==i.e&&this.startContainer.d()in
B||this.endContainer[0].nodeType==i.e&&this.endContainer.d()in B)this.Ta(u.fa,C);var h=this.O();e=h.aa;var m;if(!v)m=h.Q;h=this.document.body.createTextRange();h.moveToElementText(e[0]);h.moveStart("character",1);if(m){l=this.document.body.createTextRange();l.moveToElementText(m[0]);h.setEndPoint("EndToEnd",l);h.moveEnd("character",-1)}else{for(I=e[0].nextSibling;I&&!x(I);)I=I.nextSibling;I=!(I&&I.nodeValue&&I.nodeValue.match(D))&&(l||!e[0].previousSibling||e[0].previousSibling&&d.d(e[0].previousSibling)==
"br");s=new c(this.document.createElement("span"));s.html("&#65279;");s.insertBefore(e);I&&d.insertBefore(this.document.createTextNode("\ufeff"),e)}this.setStartBefore(e);e.h();if(v){if(I){h.moveStart("character",-1);h.select();this.document.selection.clear()}else h.select();if(s){this.G(s,u.B);s.h()}}else{this.setEndBefore(m);m.h();h.select()}};w.getSelection=q;k.Mc=w;k.Selection=w;b=w.prototype;k.k.o(b,{getNative:b.z,getType:b.pb,getRanges:b.H,getStartElement:b.ob,getSelectedElement:b.kc,reset:b.reset,
selectElement:b.yc,selectRanges:b.Ab,createBookmarks2:b.Xe,createBookmarks:b.We,getCommonAncestor:b.za,scrollIntoView:b.scrollIntoView,selectBookmarks:b.Rd,removeAllRanges:b.removeAllRanges});k.on("instanceCreated",function(l){H(l.bf)})});
KISSY.Editor.add("styles",function(k){function w(E){return!E.attr("_ke_bookmark")}function q(E,K){for(var F in E)E[F]=E[F].replace(Z,function(G,J){return K[J]})}function H(E,K){if(K){E=I.clone(E);q(E.attributes,K);q(E.styles,K)}var F=this.element=this.element=(E.element||"*").toLowerCase();this.type=this.type=F=="#"||U[F]?h.Kb:W[F]?h.cb:h.Ga;this.c={definition:E}}function C(E,K){var F=K?this.xc:this.Vb;E.body.focus();for(var G=new y(E),J=G.H(),N=0;N<J.length;N++)F.call(this,J[N]);G.Ab(J)}function z(E,
K){var F;F=E.element;if(F=="*")F="span";F=new O(K.createElement(F));return t(F,E)}function t(E,K){var F=K.c.definition,G=F.attributes;F=H.xd(F);if(G)for(var J in G)E.attr(J,G[J]);if(F)E[0].style.cssText=F;return E}function r(E){var K=E.O(D),F=E.Ye();F.ec=D;F.qd=D;for(var G,J=E.document;G=F.kf();){var N=z(this,J);G=G;var L=N;N=L.d=="pre";var R=G.d=="pre",ba=!N&&R;if(N&&!R){R=G;L=L;ba=R.html();ba=o(ba,/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"");ba=ba.replace(/[ \t\r\n]*(<br[^>]*>)[ \t\r\n]*/gi,"$1");ba=
ba.replace(/([ \t\n\r]+|&nbsp;)/g," ");ba=ba.replace(/<br\b[^>]*>/gi,"\n");if(M.ie){R=R[0].ownerDocument.createElement("div");R.appendChild(L[0]);L[0].outerHTML="<pre>"+ba+"</pre>";L=new O(R.firstChild);L.h()}else L.html(ba);L=L}else if(ba)L=f(d(G),L);else G.Rb(L);G[0].parentNode.replaceChild(L[0],G[0]);if(N){G=L;N=void 0;if((N=G.ha(D,p.e))&&N.d()=="pre"){L=o(N.html(),/\n$/,"")+"\n\n"+o(G.html(),/^\n/,"");if(M.ie)G[0].outerHTML="<pre>"+L+"</pre>";else G.html(L);N.h()}}}E.moveToBookmark(K)}function o(E,
K,F){var G="",J="";E=E.replace(/(^<span[^>]+_ke_bookmark.*?\/span>)|(<span[^>]+_ke_bookmark.*?\/span>$)/gi,function(N,L,R){L&&(G=L);R&&(J=R);return""});return G+E.replace(K,F)+J}function d(E){var K=[];o(E.fb(),/(\S\s*)\n(?:\s|(<span[^>]+_ck_bookmark.*?\/span>))*\n(?!$)/gi,function(F,G,J){return G+"</pre>"+J+"<pre>"}).replace(/<pre\b.*?>([\s\S]*?)<\/pre>/gi,function(F,G){K.push(G)});return K}function f(E,K){for(var F=K[0].ownerDocument.createDocumentFragment(),G=0;G<E.length;G++){var J=E[G];J=J.replace(/(\r\n|\r)/g,
"\n");J=o(J,/^[ \t]*\n/,"");J=o(J,/\n$/,"");J=o(J,/^[ \t]+|[ \t]+$/g,function(L,R){return L.length==1?"&nbsp;":R?" "+Array(L.length).join("&nbsp;"):Array(L.length).join("&nbsp;")+" "});J=J.replace(/\n/g,"<br>");J=J.replace(/[ \t]{2,}/g,function(L){return Array(L.length).join("&nbsp;")+" "});var N=K.K();N.html(J);F.appendChild(N[0])}return F}function c(E){var K=E.document;if(E.collapsed){K=z(this,K);E.insertNode(K);E.G(K,m.J)}else{var F=this.element,G=this.c.definition,J,N=k.m[F]||(J=D,k.m.span),L=
E.O();E.Oa(m.Hb);E.trim();var R=E.O(),ba=R.aa;R=R.Q;for(var $=ba,da;$&&$[0];){var Y=l;if(e.g($,R)){$=v;Y=D}else{var aa=$[0].nodeType,fa=aa==p.e?$.d():v;if(fa&&$.attr("_ke_bookmark")){$=$.v(D);continue}if(!fa||N[fa]&&($.Ka(R)|A.$|A.ea|A.Z)==A.$+A.ea+A.Z&&(!G.childRule||G.childRule($))){var ha=$.parent();if(ha&&ha[0]&&((k.m[ha.d()]||k.m.span)[F]||J)&&(!G.parentRule||G.parentRule(ha))){if(!da&&(!fa||!k.m.ca[fa]||($.Ka(R)|A.$|A.ea|A.Z)==A.$+A.ea+A.Z)){da=new Q(K);da.setStartBefore($)}if(aa==p.f||aa==
p.e&&!$[0].childNodes.length){aa=$;for(var ga;(Y=!aa.Ja(w))&&(ga=aa.parent(),N[ga.d()])&&(ga.Ka(ba)|A.da|A.ea|A.Z)==A.da+A.ea+A.Z&&(!G.childRule||G.childRule(ga));)aa=ga;da.setEndAfter(aa)}}else Y=D}else Y=D;$=$.v()}if(Y&&da&&!da.collapsed){Y=z(this,K);aa=da.za();fa={bh:{},Ne:{},fd:{},ed:{}};for(var ea,ia,ja;Y&&aa&&Y[0]&&aa[0];){if(aa.d()==F){for(ea in G.attributes)if(!(fa.ed[ea]||!(ja=aa.attr(ia))))if(Y.attr(ea)==ja)Y.removeAttr(ea);else fa.ed[ea]=1;for(ia in G.styles)if(!(fa.fd[ia]||!(ja=aa.L(ia))))if(Y.L(ia)==
ja)Y.L(ia,"");else fa.fd[ia]=1;if(!Y.eb()){Y=v;break}}aa=aa.parent()}if(Y){Y[0].appendChild(da.extractContents());n(this,Y);da.insertNode(Y);Y.ra();M.ie||Y[0].normalize()}else{Y=new O(K.createElement("span"));Y[0].appendChild(da.extractContents());da.insertNode(Y);n(this,Y);Y.h(S)}da=v}}ba.h();R.h();E.moveToBookmark(L);E.Ta(m.Kc)}}function j(E){E.Oa(m.Hb);var K=E.O(),F=K.aa;if(E.collapsed){for(var G=new P(F.parent()),J,N=0,L;N<G.elements.length&&(L=G.elements[N]);N++){if(L==G.w||L==G.D)break;if(this.ja(L)){var R=
E.bc(L,m.be),ba=!R&&E.bc(L,m.bb);if(ba||R){J=L;J.match=ba?"start":"end"}else{L.ra();L.d()==this.element?b(this,L):B(L,a(this)[L.d()])}}}if(J&&J[0]){L=F;for(N=0;;N++){R=G.elements[N];if(e.g(R,J))break;else if(R.match)continue;else R=R.K();R[0].appendChild(L[0]);L=R}e[J.match=="start"?"insertBefore":"insertAfter"](L,J)}}else{var $=K.Q,da=this;G=function(){for(var Y=new P(F.parent()),aa=new P($.parent()),fa=v,ha=v,ga=0;ga<Y.elements.length;ga++){var ea=Y.elements[ga];if(ea==Y.w||ea==Y.D)break;if(da.ja(ea))fa=
ea}for(ga=0;ga<aa.elements.length;ga++){ea=aa.elements[ga];if(ea==aa.w||ea==aa.D)break;if(da.ja(ea))ha=ea}ha&&$.Nb(ha);fa&&F.Nb(fa)};G();for(J=new O(F[0].nextSibling);J[0]!==$[0];){N=J.v();if(J[0]&&J[0].nodeType==p.e&&this.ja(J)){J.d()==this.element?b(this,J):B(J,a(this)[J.d()]);if(N[0].nodeType==p.e&&N.contains(F)){G();N=new O(F[0].nextSibling)}}J=N}}E.moveToBookmark(K)}function u(E){E=String(E);var K={};E.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(F,G,J){K[G]=
J});return K}function i(E,K){var F="";if(K!==l){F=document.createElement("span");F.style.cssText=E;F=F.style.cssText||""}else F=E;return F.replace(/\s*([;:])\s*/,"$1").replace(/([^\s;])$/,"$1;").replace(/,\s+/g,",").toLowerCase()}function a(E){if(E.c.Qd)return E.c.Qd;var K=E.c.Qd={},F=E.c.definition.overrides;if(F){I.isArray(F)||(F=[F]);for(var G=0;G<F.length;G++){var J=F[G],N,L;if(typeof J=="string")N=J.toLowerCase();else{N=J.element?J.element.toLowerCase():E.element;L=J.attributes}J=K[N]||(K[N]=
{});if(L){J=J.attributes=J.attributes||[];for(var R in L)J.push([R.toLowerCase(),L[R]])}}}return K}function b(E,K){var F=E.c.definition,G=s.mix(F.attributes,a(E)[K.d()]);F=F.styles;var J=I.isEmptyObject(G)&&I.isEmptyObject(F),N;for(N in G)if(!((N=="class"||E.c.definition.fullMatch)&&K.attr(N)!=g(N,G[N]))){J=J||!!K.Pc(N);K.removeAttr(N)}for(var L in F)if(!(E.c.definition.fullMatch&&K.L(L)!=g(L,F[L],D))){J=J||!!K.L(L);K.L(L,"")}x(K)}function g(E,K,F){var G=new O("<span>");G[F?"_4e_style":"attr"](E,
K);return G[F?"_4e_style":"attr"](E)}function n(E,K){for(var F=a(E),G=K.all(E.element),J=G.length;--J>=0;)b(E,new O(G[J]));for(var N in F)if(N!=E.element){G=K.all(N);for(J=G.length-1;J>=0;J--){var L=new O(G[J]);B(L,F[N])}}}function B(E,K){var F=K&&K.attributes;if(F)for(var G=0;G<F.length;G++){var J=F[G][0],N;if(N=E.attr(J)){var L=F[G][1];if(L===v||L.test&&L.test(N)||typeof L=="string"&&N==L)E[0].removeAttribute(J)}}x(E)}function x(E){if(!E.eb()){var K=E[0].firstChild,F=E[0].lastChild;E.h(D);if(K){K.nodeType==
p.e&&e.ra(K);F&&K!=F&&F.nodeType==p.e&&e.ra(F)}}}var D=S,l=X,v=T,I=KISSY,s=k.k,e=I.DOM,h={Kb:1,Ga:2,cb:3},m=k.oa,y=k.Mc,p=k.n,A=k.$a,Q=k.Range,O=I.Node,M=I.UA,P=k.Za,U={address:1,div:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,p:1,pre:1},W={embed:1,hr:1,img:1,li:1,object:1,ol:1,table:1,td:1,tr:1,th:1,ul:1,dl:1,dt:1,dd:1,form:1},V=/\s*(?:;\s*|$)/g,Z=/#\((.+?)\)/g;k.jg=h;H.prototype={apply:function(E){C.call(this,E,l)},remove:function(E){C.call(this,E,D)},Vb:function(E){return(this.Vb=this.type==h.Ga?c:this.type==
h.Kb?r:this.type==h.cb?v:v).call(this,E)},xc:function(E){return(this.xc=this.type==h.Ga?j:v).call(this,E)},Ke:function(E){t(E,this)},ja:function(E,K){if(!E)return l;var F=this.c.definition;if(E.d()==this.element){if(!K&&!E.eb())return D;var G=F.re;if(G)F=G;else{G={};var J=0,N=F.attributes;if(N)for(var L in N){J++;G[L]=N[L]}if(N=H.xd(F)){G.style||J++;G.style=N}G._length=J;F=F.re=G}if(F._length){for(var R in F)if(R!="_length"){J=E.attr(R)||"";if(R=="style")a:{G=F[R];J=i(J,l);typeof G=="string"&&(G=
u(G));typeof J=="string"&&(J=u(J));N=void 0;for(N in G)if(!(N in J&&(J[N]==G[N]||G[N]=="inherit"||J[N]=="inherit"))){G=l;break a}G=D}else G=F[R]==J;if(G){if(!K)return D}else if(K)return l}if(K)return D}else return D}if(R=a(this)[E.d()]){if(!(F=R.attributes))return D;for(G=0;G<F.length;G++){R=F[G][0];if(R=E.attr(R)){J=F[G][1];if(J===v||typeof J=="string"&&R==J||J.test&&J.test(R))return D}}}return l},Se:function(E){switch(this.type){case h.Kb:return this.ja(E.w||E.D,D);case h.cb:case h.Ga:for(var K=
E.elements,F=0,G;F<K.length;F++){G=K[F];if(!(this.type==h.Ga&&(e.g(G,E.w)||e.g(G,E.D))))if(!(this.type==h.cb&&!(G.d()in W)))if(this.ja(G,D))return D}}return l}};H.xd=function(E){var K=E.se;if(K)return K;K=E.styles;var F=E.attributes&&E.attributes.style||"",G="";if(F.length)F=F.replace(V,";");for(var J in K){var N=K[J],L=(J+":"+N).replace(V,";");if(N=="inherit")G+=L;else F+=L}if(F.length)F=i(F);F+=G;return E.se=F};k.kg=H;k.Style=H;var ca=H.prototype;k.k.o(ca,{apply:ca.apply,remove:ca.remove,applyToRange:ca.Vb,
removeFromRange:ca.xc,applyToObject:ca.Ke,checkElementRemovable:ca.ja,checkActive:ca.Se})});
KISSY.Editor.add("htmlparser",function(){function k(){}function w(){this.c={Ad:RegExp("<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)--\>)|(?:([^\\s>]+)\\s*((?:(?:[^\"'>]+)|(?:\"[^\"]*\")|(?:'[^']*'))*)\\/?>))","g")}}var q=KISSY,H=q.Editor,C=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,z={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},t=H.m;q.augment(w,{Ca:k,Pd:k,ma:k,Ld:k,Ra:k,parse:function(r){for(var o,
d,f=0,c;o=this.c.Ad.exec(r);){d=o.index;if(d>f){f=r.substring(f,d);c?c.push(f):this.ma(f)}f=this.c.Ad.lastIndex;if(d=o[1]){d=d.toLowerCase();if(c&&t.Dc[d]){this.Ld(c.join(""));c=T}if(!c){this.Pd(d);continue}}if(c)c.push(o[0]);else if(d=o[3]){d=d.toLowerCase();if(!/="/.test(d)){var j={},u;o=o[4];var i=!!(o&&o.charAt(o.length-1)=="/");if(o)for(;u=C.exec(o);){var a=u[1].toLowerCase();u=u[2]||u[3]||u[4]||"";j[a]=!u&&z[a]?a:u}this.Ca(d,j,i);if(!c&&t.Dc[d])c=[]}}else if(d=o[2])this.Ra(d)}r.length>f&&this.ma(r.substring(f,
r.length))}});H.j=w;H.HtmlParser=w});
KISSY.Editor.add("htmlparser-basicwriter",function(){function k(){this.c={l:[]}}var w=KISSY,q=w.Editor,H=q.k;w.augment(k,{vb:function(C){this.c.l.push("<",C)},wb:function(C,z){z?this.c.l.push(" />"):this.c.l.push(">")},kb:function(C,z){if(typeof z=="string")z=H.nc(z);this.c.l.push(" ",C,'="',z,'"')},lb:function(C){this.c.l.push("</",C,">")},text:function(C){this.c.l.push(C)},N:function(C){this.c.l.push("<!--",C,"--\>")},write:function(C){this.c.l.push(C)},reset:function(){this.c.l=[];this.c.A=X},
ic:function(C){var z=this.c.l.join("");C&&this.reset();return z}});q.j.Fb=k;q.j.BasicWriter=k;w=k.prototype;q.k.o(w,{openTag:w.vb,openTagClose:w.wb,attribute:w.kb,closeTag:w.lb,text:w.text,comment:w.N,write:w.write,reset:w.reset,getHtml:w.ic})});
KISSY.Editor.add("htmlparser-htmlwriter",function(){function k(){k.superclass.constructor.call(this);this.Bd="\t";this.Ff=" />";this.wf="\n";this.ff=z;this.Gf=C;this.c.A=z;this.c.F="";this.c.rules={};var t=q.m,r;for(r in H.mix({},t.Eb,t.Xa,t.Db,t.Hc))this.Ea(r,{A:C,Pe:C,ac:C,gd:!t[r]["#"],Oe:C});this.Ea("br",{ac:C});this.Ea("title",{A:z,ac:z});this.Ea("style",{A:z,gd:C});this.Ea("pre",{A:z})}var w=KISSY,q=w.Editor,H=q.k,C=S,z=X;w.extend(k,q.j.Fb,{vb:function(t){var r=this.c.rules[t];if(this.c.A)this.F();
else if(r&&r.Pe){this.Pa();this.F()}this.c.l.push("<",t)},wb:function(t,r){var o=this.c.rules[t];if(r)this.c.l.push(this.Ff);else{this.c.l.push(">");if(o&&o.A)this.c.F+=this.Bd}o&&o.ac&&this.Pa()},kb:function(t,r){if(typeof r=="string"){this.ff&&(r=r.replace(/&amp;/g,"&"));r=H.nc(r)}this.c.l.push(" ",t,'="',r,'"')},lb:function(t){var r=this.c.rules[t];if(r&&r.A)this.c.F=this.c.F.substr(this.Bd.length);if(this.c.A)this.F();else if(r&&r.gd){this.Pa();this.F()}this.c.l.push("</",t,">");r&&r.Oe&&this.Pa()},
text:function(t){if(this.c.A){this.F();t=H.Qa(t)}this.c.l.push(t)},N:function(t){this.c.A&&this.F();this.c.l.push("<!--",t,"--\>")},Pa:function(){this.c.l.length>0&&this.c.l.push(this.wf);this.c.A=C},F:function(){this.c.l.push(this.c.F);this.c.A=z},Ea:function(t,r){var o=this.c.rules[t];if(o)H.mix(o,r);else this.c.rules[t]=r}});q.j.Yf=k;q.j.HtmlWriter=k;w=k.prototype;q.k.o(w,{openTag:w.vb,openTagClose:w.wb,attribute:w.kb,closeTag:w.lb,text:w.text,comment:w.N,lineBreak:w.Pa,indentation:w.F,setRules:w.Ea})});
KISSY.Editor.add("htmlparser-fragment",function(){function k(){this.children=[];this.parent=H;this.c={S:w,mc:q}}var w=S,q=X,H=T,C=KISSY.Editor,z={colgroup:1,dd:1,dt:1,li:1,option:1,p:1,td:1,tfoot:1,th:1,thead:1,tr:1},t=KISSY,r=C.k,o=C.n,d=C.m,f=r.mix({table:1,ul:1,ol:1,dl:1},d.table,d.ul,d.ol,d.dl),c=d.Yd,j=d.Db;k.Ib=function(u,i){function a(h){var m;if(x.length>0)for(var y=0;y<x.length;y++){var p=x[y],A=p.name,Q=d[A],O=l.name&&d[l.name];if((!O||O[A])&&(!h||!Q||Q[h]||!d[h])){if(!m){b();m=1}p=p.clone();
p.parent=l;l=p;x.splice(y,1);y--}}}function b(){for(;D.length;)l.add(D.shift())}function g(h,m,y){m=m||l||B;if(i&&!m.type){var p,A;if((p=h.attributes&&(A=h.attributes._ke_real_element_type)?A:h.name)&&!(p in d.Cc)&&!(p in d.Eb)){p=l;l=m;n.Ca(i,{});m=l;if(y)l=p}}if(h.c.S&&h.name!="pre"){y=h.children.length;if((p=h.children[y-1])&&p.type==o.f)if(A=r.Sa(p.value))p.value=A;else h.children.length=y-1}m.add(h);if(h.yb){l=h.yb;delete h.yb}}var n=new C.j,B=new k,x=[],D=[],l=B,v=q,I;n.Ca=function(h,m,y){var p=
new C.j.Ic(h,m);if(p.pc&&y)p.rb=w;if(d.ca[h])x.push(p);else{if(h==="pre")v=w;else if(h==="br"&&v){l.add(new C.j.Lb("\n"));return}if(h==="br")D.push(p);else{var A=l.name,Q=A&&(d[A]||(l.c.S?d.div:d.span));if(Q&&!p.pc&&!l.pc&&!Q[h]){Q=q;var O;if(h in c&&A in c){A=l.children;(A=A[A.length-1])&&A.name in j||g(A=new C.j.Ic("li"),l);I=l;O=A}else if(h==A)g(l,l.parent);else{if(f[A])I||(I=l);else{g(l,l.parent,w);z[A]||x.unshift(l)}Q=w}l=O?O:l.yb||l.parent;if(Q){n.Ca.apply(this,arguments);return}}a(h);b();p.parent=
l;p.yb=I;I=0;if(p.rb)g(p);else l=p}}};n.Pd=function(h){for(var m=x.length-1;m>=0;m--)if(h==x[m].name){x.splice(m,1);return}for(var y=[],p=[],A=l;A.type&&A.name!=h;){A.c.S||p.unshift(A);y.push(A);A=A.parent}if(A.type){for(m=0;m<y.length;m++){var Q=y[m];g(Q,Q.parent)}l=A;if(l.name=="pre")v=q;A.c.S&&b();g(A,A.parent);if(A==l)l=l.parent;x=x.concat(p)}if(h=="body")i=q};n.ma=function(h){if(!l.c.mc&&!v){h=r.Qa(h);if(h.length===0)return}b();a();if(i&&(!l.type||l.name=="body")&&r.trim(h))this.Ca(i,{});v||
(h=h.replace(/[\t\r\n ]{2,}|[\t\r\n]/g," "));l.add(new C.j.Lb(h))};n.Ld=function(){};n.Ra=function(h){l.add(new C.j.$d(h))};n.parse(u);for(b();l.type;){var s=l.parent,e=l;if(i&&(!s.type||s.name=="body")&&!d.Cc[e.name]){l=s;n.Ca(i,{});s=l}s.add(e);l=s}return B};t.augment(k,{add:function(u){var i=this.children.length;if(i=i>0&&this.children[i-1]||H){if(u.c.S&&i.type==o.f){i.value=r.Sa(i.value);if(i.value.length===0){this.children.pop();this.add(u);return}}i.next=u}u.xb=i;u.parent=this;this.children.push(u);
this.c.mc=u.type==o.f||u.type==o.e&&!u.c.S},ba:function(u,i){var a;this.filterChildren=this.gc=function(){var b=new C.j.Fb;this.X.call(this,b,i,w);b=b.ic();this.children=(new k.Ib(b)).children;a=1};!this.name&&i&&i.Nd(this);this.X(u,a?H:i)},X:function(u,i){for(var a=0;a<this.children.length;a++)this.children[a].ba(u,i)}});C.j.Fa=k;C.j.Fragment=k;k.FromHtml=k.Ib;t=k.prototype;C.k.o(t,{add:t.add,writeHtml:t.ba,writeChildrenHtml:t.X})});
KISSY.Editor.add("htmlparser-element",function(){function k(z,t){z=z[0];t=t[0];return z<t?-1:z>t?1:0}function w(z,t){this.name=z;this.attributes=t||(t={});this.children=[];var r=t.qg||z,o=q.m;r=!!(o.Eb[r]||o.Xa[r]||o.Db[r]||o.Hc[r]||o.Gc[r]||r=="br");var d=!!o.Cb[z];this.rb=d;this.pc=!o[z];this.c={S:r,mc:d||!r}}var q=KISSY.Editor,H=q.n;KISSY.augment(w,{type:H.e,add:q.j.Fa.prototype.add,clone:function(){return new w(this.name,this.attributes)},ba:function(z,t){var r=this.attributes,o=this,d=o.name,
f,c,j,u;o.gc=function(){if(!u){var b=new q.j.Fb;q.j.Fa.prototype.X.call(o,b,t);o.children=(new q.j.Fa.Ib(b.ic())).children;u=1}};o.filterChildren=o.gc;if(t){for(;;){if(!(d=t.Md(d)))return;o.name=d;if(!(o=t.sc(o)))return;o.parent=this.parent;if(o.name==d)break;if(o.type!=H.e){o.ba(z,t);return}d=o.name;if(!d){this.X.call(o,z,u?T:t);return}}r=o.attributes}z.vb(d,r);for(var i=[],a=0;a<2;a++)for(f in r){c=f;j=r[f];if(a==1)i.push([f,j]);else if(t){for(;;)if(c=t.Kd(f))if(c!=f){delete r[f];f=c}else break;
else{delete r[f];break}if(c)if((j=t.Jd(o,c,j))===X)delete r[c];else r[c]=j}}z.Gf&&i.sort(k);r=i.length;for(a=0;a<r;a++){f=i[a];z.kb(f[0],f[1])}z.wb(d,o.rb);if(!o.rb){this.X.call(o,z,u?T:t);z.lb(d)}},X:function(){q.j.Fa.prototype.X.apply(this,arguments)}});q.j.Ic=w;q.j.Element=w;var C=w.prototype;q.k.o(C,{type:C.type,add:C.add,clone:C.clone,writeHtml:C.ba,writeChildrenHtml:C.X})});
KISSY.Editor.add("htmlparser-filter",function(){function k(f){this.c={dc:[],Xb:[],elements:{Fc:0},attributes:{Fc:0}};f&&this.cd(f,10)}function w(f,c){for(var j=0;f&&j<c.length;j++){var u=c[j];f=f.replace(u[0],u[1])}return f}function q(f,c,j){if(typeof c=="function")c=[c];var u,i;i=f.length;var a=c&&c.length;if(a){for(u=0;u<i&&f[u].wc<j;u++);for(i=a-1;i>=0;i--)if(a=c[i]){a.wc=j;f.splice(u,0,a)}}}function H(f,c,j){if(c)for(var u in c){var i=f[u];f[u]=C(i,c[u],j);i||f.Fc++}}function C(f,c,j){if(c){c.wc=
j;if(f){if(f.splice)q(f,c,j);else{f=f.wc>j?[c,f]:[f,c];f.filter=z}return f}else return c.filter=c}}function z(f){for(var c=f.type||f instanceof r.j.Fa,j=0;j<this.length;j++){if(c)var u=f.type,i=f.name;var a=this[j].apply(window,arguments);if(a===d)return a;if(c){if(a&&(a.name!=i||a.type!=u))return a}else if(typeof a!="string")return a;a!=undefined&&(f=a)}return f}var t=KISSY,r=t.Editor,o=r.n,d=X;t.augment(k,{cd:function(f,c){if(typeof c!="number")c=10;q(this.c.dc,f.dc,c);q(this.c.Xb,f.Xb,c);H(this.c.elements,
f.elements,c);H(this.c.attributes,f.attributes,c);this.c.text=C(this.c.text,f.text,c)||this.c.text;this.c.N=C(this.c.N,f.N,c)||this.c.N;this.c.zb=C(this.c.zb,f.zb,c)||this.c.zb},Md:function(f){return w(f,this.c.dc)},Kd:function(f){return w(f,this.c.Xb)},ma:function(f){var c=this.c.text;return c?c.filter(f):f},Ra:function(f,c){var j=this.c.N;return j?j.filter(f,c):f},Nd:function(f){var c=this.c.zb;return c?c.filter(f):f},sc:function(f){for(var c=[this.c.elements["^"],this.c.elements[f.name],this.c.elements.Pf],
j,u=0;u<3;u++)if(j=c[u]){j=j.filter(f,this);if(j===d)return T;if(j&&j!=f)return this.Od(j);if(f.parent&&!f.name)break}return f},Od:function(f){var c=f.type;return c==o.e?this.sc(f):c==o.f?new r.j.Lb(this.ma(f.value)):T},Jd:function(f,c,j){if(c=this.c.attributes[c]){f=c.filter(j,f,this);if(f===d)return d;if(typeof f!="undefined")return f}return j}});r.j.Xf=k;t=k.prototype;r.k.o(t,{addRules:t.cd,onElementName:t.Md,onAttributeName:t.Kd,onText:t.ma,onComment:t.Ra,onFragment:t.Nd,onElement:t.sc,onNode:t.Od,
onAttribute:t.Jd});r.j.Filter=k});KISSY.Editor.add("htmlparser-text",function(){function k(C){this.value=C;this.c={S:H}}var w=KISSY,q=w.Editor,H=X;w.augment(k,{type:q.n.f,ba:function(C,z){var t=this.value;z&&!(t=z.ma(t,this))||C.text(t)}});q.j.Lb=k;q.j.Text=k});
KISSY.Editor.add("htmlparser-comment",function(){function k(H){this.value=H;this.c={S:X}}var w=KISSY.Editor,q=w.n;w.j.$d=k;w.j.Comment=k;k.prototype={constructor:k,type:q.ce,ba:function(H,C){var z=this.value;if(C){if(!(z=C.Ra(z,this)))return;if(typeof z!="string"){z.parent=this.parent;z.ba(H,C);return}}H.N(z)}}});
KISSY.Editor.add("button",function(){var k=KISSY,w=k.Editor;if(w.je)k.log("TripleButton attach twice","warn");else{k=k.UIBase.create([k.UIBase.Box],{Dg:function(){var q=this,H=q.get("el");H.on("click",q.ue,q);H.on("mousedown",function(){q.get("state")=="off"&&H.addClass("ke-triplebutton-active")});H.on("mouseup mouseleave",function(){q.get("state")=="off"&&H.hasClass("ke-triplebutton-active")&&setTimeout(function(){H.removeClass("ke-triplebutton-active")},300)})},xg:function(){this.get("el").attr("title",
this.get("title"))},ug:function(q){var H=this.get("el");if(q!==undefined){H.html("<span class='ke-toolbar-item "+q+"'>");H.La()}},wg:function(q){var H=this.get("el");q!==undefined&&H.html(q)},vg:function(q){this["_"+q]()},nd:function(){this.Ce=this.get("state");this.set("state","disabled")},pd:function(){this.get("state")=="disabled"&&this.set("state",this.Ce)},ue:function(q){this.fire(this.get("state")+"Click",{mg:q});this.fire("click",{lg:this.get("state")+"Click"});q.preventDefault()},Fg:function(){this.set("state",
"on")},Eg:function(){this.set("state","off")},sg:function(){var q=this.get("el");q.removeClass("ke-triplebutton-off ke-triplebutton-disabled");q.addClass("ke-triplebutton-on")},rg:function(){var q=this.get("el");q.removeClass("ke-triplebutton-on ke-triplebutton-disabled");q.addClass("ke-triplebutton-off")},og:function(){var q=this.get("el");q.removeClass("ke-triplebutton-off ke-triplebutton-on");q.addClass("ke-triplebutton-disabled")}},{Zd:{If:{value:"off"},df:{value:"ke-triplebutton ke-triplebutton-off"},
Ng:{value:{hideFocus:S,tabIndex:-1}},Og:{value:"a"},title:{},Gg:{},text:{}}});k.eg="on";k.cg="off";k.ae="disabled";k.fg="ke-triplebutton-on";k.dg="ke-triplebutton-off";k.Vf="ke-triplebutton-disabled";w.je=k}});
KISSY.Editor.add("select",function(){function k(d){k.superclass.constructor.call(this,d);this.xe()}var w=KISSY,q=w.Node,H=w.Event,C=w.DOM,z=w.Editor;if(z.he)w.log("ke select attach more");else{k.ae=0;k.Wf=1;var t=z.m;k.Zd={ah:{},P:{},Ve:{},wa:{},Mg:{},value:{},width:{},title:{},uf:{},align:{value:["l","b"]},Ug:{hh:function(){for(var d=this.P.parent();d;){var f=d.d();if(t[f]&&t[f].div)return d;d=d.parent()}return new q(document.body)}},If:{value:1}};k.Jg=function(d){for(var f=d.width(),c=[],j=d.all("option"),
u=0;u<j.length;u++){var i=j[u];c.push({name:C.html(i),value:C.attr(i,"value")})}return new k({width:f+"px",P:d,uf:c,Ve:"ke-combox",value:d.val()})};var r=z.k.Je,o=z.k.Ze;w.extend(k,w.Base,{xe:function(){var d=this.get("container"),f=this.get("el"),c=new q("<span class='ke-select-wrap'><a onclick='return false;' class='ke-select'><span class='ke-select-text'><span class='ke-select-text-inner'></span></span><span class='ke-select-drop-wrap'><span class='ke-select-drop'></span></span></a></span>"),j=
this.get("title")||"",u=this.get("cls"),i=c.one(".ke-select-text"),a=c.one(".ke-select-text-inner");c.one(".ke-select-drop");this.get("value")!==undefined?a.html(this.Wc(this.get("value"))):a.html(j);i.css("width",this.get("width"));c.La();j&&c.attr("title",j);u&&c.addClass(u);if(f)f[0].parentNode.replaceChild(c[0],f[0]);else d&&c.appendTo(d);c.on("click",this.we,this);this.P=c;this.title=a;this.Xc=c.one("a.ke-select");z.k.Gd(this,"_prepare","_real");this.on("afterValueChange",this.Fe,this);this.on("afterStateChange",
this.Ee,this)},Wc:function(d){var f=this.get("title")||"",c=this.get("items");if(this.get("showValue"))return d||f;for(var j=0;j<c.length;j++){var u=c[j];if(u.value==d){f=u.name;break}}return f},Fe:function(d){this.title.html(this.Wc(d.tb))},Yc:function(d){d=d.tb;var f=this.ad;f.html("");if(d)for(var c=0;c<d.length;c++){var j=d[c];(new q("<a class='ke-select-menu-item' href='#' data-value='"+j.value+"'>"+j.name+"</a>",j.Ne)).appendTo(f).La()}this.Wb=f.all("a")},val:function(d){if(d!==undefined){this.set("value",
d);return this}else return this.get("value")},$c:function(){this.T.get("visible")&&this.Be()},ye:function(){function d(b){b=new q(b.target);c.contains(b)||c.g(b)||i.hide()}var f=this,c=f.P,j=f.get("popUpWidth"),u=f.Xc,i=new z.de({Bg:S,$g:f.get("menuContainer"),content:"<div>",Qg:X,df:"ke-menu",width:j?j:c.width(),zIndex:z.Yb(z.Bc.fe),Rg:X}),a=f.get("items");r.call(f,i);j=i.get("contentEl").one("div");f.T=i;H.on(window,"resize",f.$c,f);r.call(f,function(){H.remove(window,"resize",f.$c,f)});f.get("title")&&
(new q("<div class='ke-menu-title ke-select-menu-item' style='margin-top:-6px;' >"+f.get("title")+"</div>")).appendTo(j);f.ad=(new q("<div>")).appendTo(j);f.Yc({tb:a});i.on("show",function(){u.addClass("ke-select-active")});i.on("hide",function(){u.removeClass("ke-select-active")});H.on(document,"click",d);r.call(f,function(){H.remove(document,"click",d)});f.get("doc")&&H.on(f.get("doc"),"click",d);j.on("click",f.De,f);f.Wb=f.ad.all("a");H.on(j[0],"mouseenter",function(){f.Wb.removeClass("ke-menu-selected")});
r.call(f,j);f.on("afterItemsChange",f.Yc,f);f.yf=j},Ee:function(d){var f=this.P;d.tb==1?f.removeClass("ke-select-disabled"):f.addClass("ke-select-disabled")},pd:function(){this.set("state",1)},nd:function(){this.set("state",0)},De:function(d){d.halt();var f=this.T,c=this.yf;if(d=(new q(d.target)).Nc(function(i){return c.contains(i)&&i.d()=="a"},S)){var j=this.get("value"),u=d.attr("data-value");this.set("value",u);this.fire("click",{tb:u,Wg:j,name:d.html()});f.hide()}},Be:function(){var d=this.P,
f=d.offset(),c=w.clone(f),j=this.T.get("el").height(),u=this.T.get("el").width(),i=C.scrollTop(),a=C.scrollLeft(),b=C.viewportHeight(),g=C.viewportWidth();g=a+g-60;b=i+b;var n=f.top+(d.height()-2);d=f.left+d.width()-2;var B=this.get("align"),x=B[0];if(B[1]=="b"){f.top=n;if(f.top+j>b&&c.top-i>b-n)f.top=c.top-j}else{f.top=c.top-j;if(f.top<i&&c.top-i<b-n)f.top=n}if(x=="l"){if(f.left+u>g&&d-a>g-c.left)f.left=d-u}else{f.left=d-u;if(f.left<a&&d-a<g-c.left)f.left=c.left}this.T.set("xy",[f.left,f.top]);this.T.show()},
we:function(d){if(!this.qc){d.preventDefault();var f=this;d=f.P;var c=f.get("value");if(!d.hasClass("ke-select-disabled"))if(f.Xc.hasClass("ke-select-active"))f.T&&f.T.hide();else{f.qc=S;z.use("overlay",function(){f.qc=X;f.ye();c&&f.T&&f.Wb.each(function(j){j.attr("data-value")==c?j.addClass("ke-menu-selected"):j.removeClass("ke-menu-selected")})})}}},ya:function(){o.call(this);this.P.detach();this.P.remove()}});z.he=k}});
